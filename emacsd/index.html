<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>My Literate .emacs.d &#183; robbmann</title><meta name=title content="My Literate .emacs.d &#183; robbmann"><meta name=description content="It's Robb, man!"><link rel=canonical href=https://robbmann.io/emacsd/><link type=text/css rel=stylesheet href=/css/main.bundle.min.39b7a5b20cc3e1243a974332de8d5e458dd9f15f0f8e06962e8afb4c2b9ce9805c65a0f9359b396ceb5d5f8c16f9ede5d854c208fb561f4fbc5b9a05f4c3cdec.css integrity="sha512-ObelsgzD4SQ6l0My3o1eRY3Z8V8PjgaWLor7TCuc6YBcZaD5NZs5bOtdX4wW+e3l2FTCCPtWH0+8W5oF9MPN7A=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.d7d952fbb69589ecf9390cb9ba98d08e09534f1cbe0aa285132ed0a2a14de5185a184c5b0583f11d12204799f5fcaec6326536421d513d01c020494639138ab0.js integrity="sha512-19lS+7aViez5OQy5upjQjglTTxy+CqKFEy7QoqFN5RhaGExbBYPxHRIgR5n1/K7GMmU2Qh1RPQHAIElGOROKsA==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="My Literate .emacs.d"><meta property="og:description" content="Table of Contents Goals Notable Features Tangling Inspirations Getting Emacs Header Custom Proxy settings Packages OS-specific Configuration Font Theme Emacs&rsquo; Built-in Settings Keybindings Text Completion Language-specific major modes Tool configuration Don&rsquo;t forget about these Footer Want to use it?"><meta property="og:type" content="article"><meta property="og:url" content="https://robbmann.io/emacsd/"><meta property="article:section" content><meta property="og:site_name" content="robbmann"><meta name=twitter:card content="summary"><meta name=twitter:title content="My Literate .emacs.d"><meta name=twitter:description content="Table of Contents Goals Notable Features Tangling Inspirations Getting Emacs Header Custom Proxy settings Packages OS-specific Configuration Font Theme Emacs&rsquo; Built-in Settings Keybindings Text Completion Language-specific major modes Tool configuration Don&rsquo;t forget about these Footer Want to use it?"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"My Literate .emacs.d","headline":"My Literate .emacs.d","abstract":"Table of Contents Goals Notable Features Tangling Inspirations Getting Emacs Header Custom Proxy settings Packages OS-specific Configuration Font Theme Emacs\u0026rsquo; Built-in Settings Keybindings Text Completion Language-specific major modes Tool configuration Don\u0026rsquo;t forget about these Footer Want to use it?","inLanguage":"en","url":"https:\/\/robbmann.io\/emacsd\/","author":{"@type":"Person","name":"Robert Enzmann"},"mainEntityOfPage":"true","wordCount":"8668"}]</script><meta name=generator content="Hugo 0.105.0"><meta name=author content="Robert Enzmann"><link href=mailto:robbenzmann@gmail.com rel=me><link href=https://github.com/renzmann rel=me><link href=https://www.linkedin.com/in/renzmann rel=me><link href=https://reddit.com/user/renzmann rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>robbmann</a></div><nav><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>Posts</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/emacsd/ title="My Literate .emacs.d">.emacs.d</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://github.com/renzmann title>GitHub</a></li><li class="ltr:text-right rtl:text-left ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></li></ul></nav></header><main id=main-content class="relative grow"><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">My Literate .emacs.d</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="0001-01-01 00:00:00 +0000 UTC">1 January 0001</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">41 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="min-w-0 min-h-0 max-w-prose"><div class="ox-hugo-toc toc"><div class=heading>Table of Contents</div><ul><li><a href=#goals>Goals</a></li><li><a href=#notable-features>Notable Features</a></li><li><a href=#tangling>Tangling</a></li><li><a href=#inspirations>Inspirations</a></li><li><a href=#getting-emacs>Getting Emacs</a></li><li><a href=#header>Header</a></li><li><a href=#custom>Custom</a></li><li><a href=#proxy-settings>Proxy settings</a></li><li><a href=#packages>Packages</a></li><li><a href=#os-specific-configuration>OS-specific Configuration</a></li><li><a href=#font>Font</a></li><li><a href=#theme>Theme</a></li><li><a href=#emacs-built-in-settings>Emacs&rsquo; Built-in Settings</a></li><li><a href=#keybindings>Keybindings</a></li><li><a href=#text-completion>Text Completion</a></li><li><a href=#language-specific-major-modes>Language-specific major modes</a></li><li><a href=#tool-configuration>Tool configuration</a></li><li><a href=#don-t-forget-about-these>Don&rsquo;t forget about these</a></li><li><a href=#footer>Footer</a></li></ul></div><p>Want to use it? Go ahead!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone https://github.com/renzmann/.emacs.d ~/.emacs.d
</span></span></code></pre></div><p>All external dependency sources are explicitly included under the <code>elpa/</code>
directory, meaning it&rsquo;s as simple as &ldquo;clone-n-go&rdquo;. Opening this document under
my configuration looks like so:</p><figure><img class="my-0 rounded-md" src=https://user-images.githubusercontent.com/32076780/209576965-0c428bff-bea2-4b06-8373-37dfa4e4d86d.png alt></figure><p>If you prefer a prettier reading experience, check out this same document weaved
into <a href=https://robbmann.io/emacsd/>my website.</a> Or, if you&rsquo;re already reading this on my website, check out
the <a href=https://github.com/renzmann/.emacs.d/>source code on GitHub</a>.</p><h2 id=goals class="relative group">Goals <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#goals aria-label=Anchor>#</a></span></h2><p>If I had to sum up the theme of my configuration, it would be &ldquo;vanilla extract&rdquo;.
In only a few instances do I change overt behavior of Emacs, the most noticeable
departure of course being the color theme with org-modern. Even with those,
though, I want a configuration that fits my hands in such a way that I remain
comfortable using <code>emacs -Q</code> with very little disruption to my normal muscle
memory and workflow.</p><p>Aside from these aesthetic and philosophical reasons, there are practical
concerns this configuration needs to address. I spend my time on Windows for
games, macOS or Linux with remote machines for work, and desktop Linux for
personal projects like building my website. Some of these situations enforce a
very slow internet connection and tight security measures for Tramp, which can
cause modern, &ldquo;live updating&rdquo; features like <code>corfu</code> and <code>consult</code> to hang Emacs. In
other cases, I have no access to the outside internet at all (so no ELPA or
MELPA updates). Hence, keeping only a small number of external dependencies
under <code>elpa/</code> maximizes portability and maintainability between systems.</p><p>Altogether, I wind up using Emacs 28+ on all three of the major platforms, in both
GUI and TTY mode. So this config is designed to work equally well for:</p><table><thead><tr><th>platform</th><th>terminal</th><th>GUI</th><th>ssh + TTY</th><th>Tramp</th></tr></thead><tbody><tr><td>Linux</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>macOS</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>Windows</td><td>❌</td><td>✅</td><td>❌</td><td>✅</td></tr></tbody></table><p>Once I figure out how to get colors working in Windows terminal, I&rsquo;ll update
this table. For now though, the 16 bit colors don&rsquo;t react to my color theme,
and so on Windows I rely singularly on GUI mode, rather than WSL or Emacs inside
Alacritty.</p><h2 id=notable-features class="relative group">Notable Features <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#notable-features aria-label=Anchor>#</a></span></h2><p>You may notice that despite the laudable goal of intended minimalism, this
document is is still quite long, as I have found many (ever increasing) quirky
behaviors of Emacs that I tweak. Most of my time is spent in Org, SQL, Python,
Bash, and Markdown, so the majority of configuration lies around these sections.</p><p>I do make changes to things that I feel &ldquo;should have been included.&rdquo; Some
examples of this are:</p><ol><li>Additional major modes for languages like Markdown, Go, and Rust</li><li>Error message support for <code>pyright</code> in a <code>*Compilation*</code> buffer</li><li>Reasonable indentation behavior for SQL files</li><li>Updating buffers automatically if their contents change on disk</li><li>Syntax highlighting for Source blocks in Markdown</li><li>Handling ANSI color escape codes in shell output, compilation, and VC buffers</li><li>Ability to run TUI interfaces in comint-mode (shell, eshell) on Linux and
macOS</li></ol><h2 id=tangling class="relative group">Tangling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tangling aria-label=Anchor>#</a></span></h2><p>My configuration is a single literate programming document, which is tangled
into the standard <code>init.el</code> and supporting files. This is so I can keep track of
all the crazy things I try, and explain them inline with the final code I decide
to include. Some platforms like GitHub can render this document in a limited
way, but to see all the final configuration values I use you will likely have to
view this document in Emacs itself.</p><p>Why use a literate document for my configuration? Basically, as I added more
comments and reminders about what some line of code was doing, where I got it
from, and why it might be commented out, the prose grew longer than the actual
code, and so a change of medium felt prudent. In my case, that&rsquo;s the venerable
<a href=https://orgmode.org/>Org mode</a>, which comes with Emacs and serves as a way to seamlessly weave
commentary and code together.</p><h2 id=inspirations class="relative group">Inspirations <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#inspirations aria-label=Anchor>#</a></span></h2><p>Here&rsquo;s where I put the typical quote about standing on one form of shoulders or
another. I steal quite a lot from other, more qualified Emacs community
contributors, such as:</p><ul><li><a href=https://protesilaos.com/>Protesilaos Stavrou</a></li><li><a href=https://panadestein.github.io/emacsd/>Ramón Panadestein</a></li><li><a href=https://www.masteringemacs.org/>Mickey Petersen</a></li><li><a href=https://github.com/minad>Daniel Mendler</a></li><li><a href=https://github.com/oantolin>Omar Antolín Camarena</a></li><li><a href=https://www.lucacambiaghi.com/vanilla-emacs/readme.html>Luca&rsquo;s Literate Config</a></li></ul><h2 id=getting-emacs class="relative group">Getting Emacs <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#getting-emacs aria-label=Anchor>#</a></span></h2><p>For a while I would try to compile Emacs myself, but installing the whole
compilation toolchain hasn&rsquo;t been worth it lately, especially on Windows.
Instead, I&rsquo;ve started simply downloading emacs from these sources on each of the
platforms:</p><h3 id=windows class="relative group">Windows <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#windows aria-label=Anchor>#</a></span></h3><p>I go to the <a href=https://alpha.gnu.org/gnu/emacs/pretest/windows/emacs-29/>pretest FTP</a> to get the latest version of Emacs. Usually not quite
up-to-date with the master branch, but still one version number ahead of the
most recent official release.</p><h3 id=mac class="relative group">Mac <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#mac aria-label=Anchor>#</a></span></h3><p>On macOS, I&rsquo;ve had the best luck with <a href=https://github.com/jimeh/emacs-builds/releases>jimeh&rsquo;s nightly builds</a>. These Emacs.app
bundles have no external dependencies, signed with a developer certificate, and
notarized by Apple, so it <em>just works</em>. Even without administrator permissions,
you can drag the bundle to the &ldquo;Applications&rdquo; folder under your user home
instead, and Emacs still works beautifully.</p><p>In particular, this feature has saved me a lot of headaches that I ran into
compiling Emacs on my own:</p><blockquote><p>Emacs.app is signed with a developer certificate and notarized by Apple.</p></blockquote><p>Very nice!</p><h3 id=linux class="relative group">Linux <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#linux aria-label=Anchor>#</a></span></h3><p>Depending on the machine, I get Emacs one of several ways in a GNU/Linux setup.
These rank from highest to lowest priority:</p><ol><li>Through my system package manager, such as <code>sudo apt-get install emacs</code> or <code>pacman -S emacs</code></li><li>Through the <a href=https://ftp.gnu.org/gnu/emacs/>official FTP</a></li><li>Through the <a href=https://alpha.gnu.org/gnu/emacs/pretest/windows/emacs-29/>pretest FTP</a></li><li>Through <a href=https://github.com/mariusvniekerk/condax>condax</a></li><li>Compiling it myself</li></ol><h4 id=compiling class="relative group">Compiling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#compiling aria-label=Anchor>#</a></span></h4><p>If I do ever want to compile it myself, these are the options I use, making sure
to export the correct <code>CC</code> and <code>GCC</code> variables:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone git://git.savannah.gnu.org/emacs.git --branch emacs-29 --depth <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>CC</span><span class=o>=</span>/usr/bin/gcc-10 <span class=nv>CXX</span><span class=o>=</span>/usr/bin/gcc-10
</span></span><span class=line><span class=cl>./autogen.sh
</span></span><span class=line><span class=cl>./configure <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --prefix<span class=o>=</span>/c/emacs-29 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-native-compilation <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-tree-sitter <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-gnutls <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-jpeg <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-png <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-rsvg <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-tiff <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-wide-int <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-xft <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-xml2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --with-xpm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --without-dbus <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --without-pop
</span></span><span class=line><span class=cl>make --jobs<span class=o>=</span><span class=k>$(</span>nproc<span class=k>)</span>
</span></span><span class=line><span class=cl>sudo make install
</span></span></code></pre></div><h2 id=header class="relative group">Header <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#header aria-label=Anchor>#</a></span></h2><p>To comply with the Emacs <a href=https://www.gnu.org/software/emacs/manual/html_node/elisp/Library-Headers.html>conventions for libraries</a>, the tangled init.el must
have the following header and <a href=#footer>footer:</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;;; init.el --- Robb&#39;s Emacs configuration -*- lexical-binding: t -*-</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Copyright (C) 2022 Robert Enzmann</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Author: Robb Enzmann &lt;robbenzmann@gmail.com&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>;; Keywords: internal</span>
</span></span><span class=line><span class=cl><span class=c1>;; URL: https://robbmann.io/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;;; Commentary:</span>
</span></span><span class=line><span class=cl><span class=c1>;; A mostly minimal, reproducible Emacs configuration.  This file is</span>
</span></span><span class=line><span class=cl><span class=c1>;; automatically tangled from README.org, with header/footer comments on each</span>
</span></span><span class=line><span class=cl><span class=c1>;; code block that allow for de-tangling the source back to README.org when</span>
</span></span><span class=line><span class=cl><span class=c1>;; working on this file directly.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;;; Code:</span>
</span></span></code></pre></div><h2 id=custom class="relative group">Custom <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#custom aria-label=Anchor>#</a></span></h2><p>I prefer having <code>custom</code> modify its own file. This next snippet ensures any
<code>package-install</code> or <code>custom</code> edits go to <code>custom.el</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>custom-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;custom.el&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>custom-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>load</span> <span class=nv>custom-file</span> <span class=ss>&#39;noerror</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=proxy-settings class="relative group">Proxy settings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#proxy-settings aria-label=Anchor>#</a></span></h2><p>When behind a corporate proxy, we might have to authenticate before we can pull
packages off MELPA or ELPA. Emacs only uses the HOST and PORT portions of the
<code>http_proxy</code> and <code>https_proxy</code> environment variables, so we need to set LOGIN (user
id) and PASSWORD ourselves.</p><p>I store the login, port, and host variables in a <code>proxy.el</code> file (obviously
outside version control) when I&rsquo;m on a machine that&rsquo;s behind an http proxy. We
grab the password interactively when such a file exists.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/enable-proxy</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Turn on HTTP proxy.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>proxy-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;proxy.el&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>proxy-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>load-file</span> <span class=nv>proxy-file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-proxy-services</span>
</span></span><span class=line><span class=cl>            <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;no_proxy&#34;</span> <span class=o>.</span> <span class=s>&#34;^\\(localhost\\|10.*\\)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;http&#34;</span> <span class=o>.</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>renz/proxy-host</span> <span class=s>&#34;:&#34;</span> <span class=nv>renz/proxy-port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=s>&#34;https&#34;</span> <span class=o>.</span> <span class=p>(</span><span class=nf>concat</span> <span class=nv>renz/proxy-host</span> <span class=s>&#34;:&#34;</span> <span class=nv>renz/proxy-port</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>url-http-proxy-basic-auth-storage</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nf>list</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>concat</span> <span class=nv>renz/proxy-host</span> <span class=s>&#34;:&#34;</span> <span class=nv>renz/proxy-port</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>cons</span> <span class=nv>renz/proxy-login</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>base64-encode-string</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nf>concat</span> <span class=nv>renz/proxy-login</span> <span class=s>&#34;:&#34;</span> <span class=p>(</span><span class=nv>password-read</span> <span class=s>&#34;Proxy password: &#34;</span><span class=p>))))))))))</span>
</span></span></code></pre></div><h2 id=packages class="relative group">Packages <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#packages aria-label=Anchor>#</a></span></h2><p>The initial cornerstone of every Emacs configuration is a decision on package
management and configuration. I opt for <code>use-package</code> and <code>package.el</code>, since both
are built-in to Emacs 29+, which helps maximize stability and portability.</p><p>To avoid loading packages twice, <a href=https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Installation.html>the manual</a> recommends disabling
<code>package-enable-at-startup</code> in <code>init.el</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;package</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>package-enable-at-startup</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>MELPA (Milkypostman&rsquo;s Emacs Lisp Package Archive) is the largest repository for
elisp sources that aren&rsquo;t a part of the official GNU ELPA. To install packages
from it, we need it on the <code>package-archives</code> list.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;package-archives</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;melpa&#34;</span> <span class=o>.</span> <span class=s>&#34;https://melpa.org/packages/&#34;</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>I do not use the <code>:ensure t</code> keyword in <code>use-package</code> declarations to install
packages. Instead, I rely on <code>M-x package-install</code> and <code>M-x package-delete</code>, and
only permit <code>use-package</code> to handle the configuration and loading of packages. As
mentioned in the introduction, each package&rsquo;s source is explicitly included into
version control of my configuration, so I don&rsquo;t worry too much about pinning
package versions in this file. When I want to update a package, I use <code>M-x package-update</code>, the <code>package.el</code> user interface, or delete the package&rsquo;s source
folder and use <code>renz/package-sync</code> (defined below). Should something go wrong, I
roll back to a previous commit. So far, this method has been reliable for
keeping my <code>init.el</code> (this README), <code>custom.el</code>, the <code>package-selected-packages</code>
variable, and <code>elpa/</code> directory all in sync with one another.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/package-sync</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Remove unused sources and install any missing ones.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>package-autoremove</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>package-install-selected-packages</span><span class=p>))</span>
</span></span></code></pre></div><p>There are also a few hand-made packages I keep around in a special
<code>.emacs.d/site-lisp</code> directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;load-path</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;site-lisp/&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=os-specific-configuration class="relative group">OS-specific Configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#os-specific-configuration aria-label=Anchor>#</a></span></h2><h3 id=microsoft-windows class="relative group">Microsoft Windows <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#microsoft-windows aria-label=Anchor>#</a></span></h3><p>Windows, funnily enough, has some trouble registering the Windows key as a
usable modifier for Emacs. In fact, <code>s-l</code> will <em>never</em> be an option, since it&rsquo;s
handled at the hardware level. I also add a few nice-to-haves, like setting the
default shell to <code>pwsh</code> and explicitly pathing out <code>aspell</code>, which I always install
with <code>msys64</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/windowsp</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Are we on Microsoft Windows?&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>memq</span> <span class=nv>system-type</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>windows-nt</span> <span class=nv>cygwin</span> <span class=nv>ms-dos</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>renz/windowsp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; Alternate ispell when we&#39;ve got msys on Windows</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-program-name</span> <span class=s>&#34;aspell.exe&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>For a time I considered enabling the use of the winkey like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>w32-pass-lwindow-to-system</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>w32-lwindow-modifier</span> <span class=ss>&#39;super</span><span class=p>)</span> <span class=c1>; Left Windows key</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>w32-pass-rwindow-to-system</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>w32-rwindow-modifier</span> <span class=ss>&#39;super</span><span class=p>)</span> <span class=c1>; Right Windows key</span>
</span></span></code></pre></div><p>Followed by enabling specific chords, such as &ldquo;winkey+a&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>w32-register-hot-key</span> <span class=p>[</span><span class=nv>s-a</span><span class=p>])</span>
</span></span></code></pre></div><p>Since I&rsquo;ve taken a more TTY-friendly approach for my config in general, where
super can be a bit tough to integrate with both the windowing application <em>and</em>
the terminal emulator, I&rsquo;ve mostly given up on the GUI key in favor of other
chords, especially the <code>C-c</code> ones.</p><h3 id=macos class="relative group">macOS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#macos aria-label=Anchor>#</a></span></h3><p>Launching Emacs from the typical application launcher or command-space usually
won&rsquo;t capture any modifications to <code>$PATH</code>, typically handled in a file like
<code>~/.profile</code> or <code>~/.bashrc</code>. So, the main configuration included here is from
<a href=https://github.com/purcell/exec-path-from-shell>exec-path-from-shell</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>system-type</span> <span class=ss>&#39;darwin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>exec-path-from-shell-arguments</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;-l&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>exec-path-from-shell-initialize</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=font class="relative group">Font <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#font aria-label=Anchor>#</a></span></h2><p>Fonts are a tricky business. I can&rsquo;t always have my favorite fonts installed
everywhere, and I can&rsquo;t expect everyone who might want to try out this
configuration to use the same fonts I do. So I made them optional. If a file
<code>~/.emacs.d/font.el</code> exists, then this section will simply read it and apply
whatever settings are there.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>when-let*</span> <span class=p>((</span><span class=nv>font-file</span> <span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;font.el&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>exists</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>font-file</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>load-file</span> <span class=nv>font-file</span><span class=p>))</span>
</span></span></code></pre></div><p>Typically I&rsquo;ll have a per-OS font configuration in there, <a href=https://github.com/renzmann/.emacs.d/blob/main/font.el>typically with some
variant of Hack Nerd Mono.</a></p><h2 id=theme class="relative group">Theme <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#theme aria-label=Anchor>#</a></span></h2><p><a href=https://protesilaos.com/>Prot&rsquo;s</a> themes have been reliably legible in nearly every situation. Now with
his new <a href=https://protesilaos.com/emacs/ef-themes>ef-themes</a>, they&rsquo;re pretty, too! The <code>ef-themes-headings</code> variable creates
larger, bolder headings when in <a href=#org-mode>Org-mode</a>, and <code>ef-themes-to-toggle</code> allows me to
quickly switch between preset light and dark themes depending on the ambient
light of the room I&rsquo;m in.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ef-themes</span>
</span></span><span class=line><span class=cl>  <span class=nb>:if</span> <span class=p>(</span><span class=nv>display-graphic-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:demand</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c m&#34;</span> <span class=o>.</span> <span class=nv>ef-themes-toggle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>ef-themes-headings</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>((</span><span class=mi>0</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.9</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>1</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>2</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>3</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>4</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>5</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span> <span class=c1>; absence of weight means `bold&#39;</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>6</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=mi>7</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=no>t</span> <span class=o>.</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>ef-themes-to-toggle</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>ef-cherie</span> <span class=nv>ef-kassio</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>load-theme</span> <span class=ss>&#39;ef-cherie</span> <span class=nb>:no-confirm</span><span class=p>))</span>
</span></span></code></pre></div><p>I LOVE these themes from <code>ef-themes</code>:</p><ul><li><strong>Light</strong><ul><li><code>ef-frost</code></li><li><code>ef-light</code></li><li><code>ef-summer</code></li></ul></li><li><strong>Dark</strong><ul><li><code>ef-cherie</code></li><li><code>ef-trio-dark</code></li><li><code>ef-winter</code></li></ul></li></ul><p>I&rsquo;ve mostly settled on <code>ef-cherie</code>, but sometimes switch to the others above.</p><h3 id=messed-up-colors-in-tty-mode class="relative group">Messed up colors in TTY mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#messed-up-colors-in-tty-mode aria-label=Anchor>#</a></span></h3><p>In TTY mode, I use <a href=https://sw.kovidgoyal.net/kitty/>kitty</a>. I have had trouble with dark blue or red themes in
Alacritty, and on Windows terminal. There is probably some hacking I could do
on my <code>$TERM</code> variable to try and sort that out, but since it just kinda works in
Kitty for me, I haven&rsquo;t spent too much time looking into it.</p><h2 id=emacs-built-in-settings class="relative group">Emacs&rsquo; Built-in Settings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#emacs-built-in-settings aria-label=Anchor>#</a></span></h2><p>My settings for base Emacs behavior. Assuming I ran with <em>no</em> plugins (ala <code>emacs -Q</code>), I would still set most of these by hand at one point or another. This
section is designed for variables that modify Emacs and its editing behavior
directly. Configuation for built-in tools, such as Dired, Tramp, and
Tree-sitter are located under <a href=#tool-configuration>Tool configuration</a>.</p><h3 id=stop-stupid-bell class="relative group">Stop stupid bell <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#stop-stupid-bell aria-label=Anchor>#</a></span></h3><p>This snippet has a special place in my heart, because it was the first two lines
of elisp I wrote when first learning Emacs. It is the central kernel around
which my <code>~/.emacs</code> and later <code>~/.emacs.d/init.el</code> grew.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Stop stupid bell</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>ring-bell-function</span> <span class=ss>&#39;ignore</span><span class=p>)</span>
</span></span></code></pre></div><p>The bell is really, <em>really</em> annoying.</p><h3 id=start-a-server-for-emacsclient class="relative group">Start a server for <code>emacsclient</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#start-a-server-for-emacsclient aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>server-start</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=don-t-hang-when-visiting-files-with-extremely-long-lines class="relative group">Don&rsquo;t hang when visiting files with extremely long lines <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#don-t-hang-when-visiting-files-with-extremely-long-lines aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-so-long-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=unicode class="relative group">Unicode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#unicode aria-label=Anchor>#</a></span></h3><p>Sometimes (especially on Windows), Emacs gets confused about what encoding to
use. These settings try to prevent that confusion.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>prefer-coding-system</span>       <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-default-coding-systems</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-terminal-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-keyboard-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>default-buffer-file-coding-system</span> <span class=ss>&#39;utf-8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>x-select-request-type</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>UTF8_STRING</span> <span class=nv>COMPOUND_TEXT</span> <span class=nv>TEXT</span> <span class=nv>STRING</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=mode-line class="relative group">Mode line <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#mode-line aria-label=Anchor>#</a></span></h3><p>It&rsquo;s easy for the mode line to get cluttered once things like Flymake and eglot
kick in. When I was starting out, I used to have these two settings:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>display-battery-mode</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>display-time-day-and-date</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>display-time</span><span class=p>)</span>
</span></span></code></pre></div><p>After a while I noticed that I&rsquo;m almost never running Emacs in a full screen
where I can&rsquo;t see the battery or date in the corner of my window manager, so
they were just wasting mode line space. Nowadays I simply opt for column mode
and a dimmed mode line in non-selected windows.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>column-number-mode</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=nv>mode-line-in-non-selected-windows</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=remember-minibuffer-history class="relative group">Remember minibuffer history <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#remember-minibuffer-history aria-label=Anchor>#</a></span></h3><p>Found this on a <a href="https://www.youtube.com/watch?v=51eSeqcaikM">System Crafters video</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>history-length</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>savehist-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=render-ascii-color-escape-codes class="relative group">Render ASCII color escape codes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#render-ascii-color-escape-codes aria-label=Anchor>#</a></span></h3><p>For files containing color escape codes, this provides a way to render the
colors in-buffer. Provided by a <a href=https://stackoverflow.com/a/3072831/13215205>helpful stackoverflow answer</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/display-ansi-colors</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Render colors in a buffer that contains ASCII color escape codes.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;ansi-color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>inhibit-read-only</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ansi-color-apply-on-region</span> <span class=p>(</span><span class=nf>point-min</span><span class=p>)</span> <span class=p>(</span><span class=nf>point-max</span><span class=p>))))</span>
</span></span></code></pre></div><h4 id=colored-output-in-eshell-and-compilation class="relative group">Colored output in <code>eshell</code> and <code>*compilation*</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#colored-output-in-eshell-and-compilation aria-label=Anchor>#</a></span></h4><p>In <code>*compilation*</code> mode, we just use the &ldquo;display colors&rdquo; function from above.
Enable colors in the <code>*compilation*</code> buffer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;compilation-filter-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/display-ansi-colors</span><span class=p>)</span>
</span></span></code></pre></div><p>For <code>eshell</code>, this is copy-pasted from a <a href=https://emacs.stackexchange.com/questions/9517/colored-git-output-in-eshell>stack overflow question</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;eshell-preoutput-filter-functions</span>  <span class=nf>#&#39;</span><span class=nv>ansi-color-apply</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=xterm-color class="relative group">xterm-color <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#xterm-color aria-label=Anchor>#</a></span></h4><p>Soon, I&rsquo;d like to swap out my hacks above for this more robust package:
<a href=https://github.com/atomontage/xterm-color/tree/master>https://github.com/atomontage/xterm-color/tree/master</a></p><h3 id=recent-files-menu class="relative group">Recent files menu <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#recent-files-menu aria-label=Anchor>#</a></span></h3><p>This enables &ldquo;File -> Open Recent&rdquo; from the menu bar and using <code>completing-read</code> over the <code>recentf-list</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>recentf-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/find-recent-file</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Find a file that was recently visted using </span><span class=ss>`completing-read&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>find-file</span> <span class=p>(</span><span class=nf>completing-read</span> <span class=s>&#34;Find recent file: &#34;</span> <span class=nv>recentf-list</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=fill-column class="relative group">Fill-column <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fill-column aria-label=Anchor>#</a></span></h3><p>Regardless of whether we&rsquo;re doing visual fill or hard fill, I like the default
at around 80 characters, and I&rsquo;ll manually change it per buffer if I want
something different</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>fill-column</span> <span class=mi>80</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=scroll-bar class="relative group">Scroll bar <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#scroll-bar aria-label=Anchor>#</a></span></h3><p>I toggle this one on/off sometimes depending on how I feel and which OS I&rsquo;m
currently on.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>scroll-bar-mode</span> <span class=mi>-1</span><span class=p>)</span>
</span></span></code></pre></div><p>By default, though, I prefer it to be off when I start Emacs.</p><h3 id=window-margins-and-fringe class="relative group">Window margins and fringe <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#window-margins-and-fringe aria-label=Anchor>#</a></span></h3><p>This hunk adds some space around all sides of each window so that we get a clear
space between the edge of the screen and the fringe. This helps <code>src</code> blocks look
clean and well delineated for <a href=#org-modern>org-modern</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/modify-margins</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Add some space around each window.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>modify-all-frames-parameters</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>((</span><span class=nv>right-divider-width</span> <span class=o>.</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>internal-border-width</span> <span class=o>.</span> <span class=mi>40</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>face</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>window-divider</span>
</span></span><span class=line><span class=cl>                  <span class=nv>window-divider-first-pixel</span>
</span></span><span class=line><span class=cl>                  <span class=nv>window-divider-last-pixel</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>face-spec-reset-face</span> <span class=nv>face</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>set-face-foreground</span> <span class=nv>face</span> <span class=p>(</span><span class=nv>face-attribute</span> <span class=ss>&#39;default</span> <span class=nb>:background</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>set-face-background</span> <span class=ss>&#39;fringe</span> <span class=p>(</span><span class=nv>face-attribute</span> <span class=ss>&#39;default</span> <span class=nb>:background</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>renz/modify-margins</span><span class=p>)</span>
</span></span></code></pre></div><p>We also need to make sure this runs each time we change the <code>ef-theme</code>, otherwise
the old background color will linger in the margins.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;ef-themes-post-load-hook</span> <span class=ss>&#39;renz/modify-margins</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=automatically-visit-symlink-sources class="relative group">Automatically visit symlink sources <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#automatically-visit-symlink-sources aria-label=Anchor>#</a></span></h3><p>When navigating to a file that is a symlink, this automatically redirects us to
the source file it&rsquo;s pointing to.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>find-file-visit-truename</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>vc-follow-symlinks</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=indent-with-spaces-by-default class="relative group">Indent with spaces by default <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#indent-with-spaces-by-default aria-label=Anchor>#</a></span></h3><p>For the most part I edit Python, SQL, Markdown, Org, and shell scripts. All of
these favor spaces over tabs, so I prefer this as the default.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>indent-tabs-mode</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>Generally, though, indentation behavior is set by major-mode functions, which
may or may not use Emacs&rsquo; built-in indentation functions. For instance, when
trying to find the functions behind indentation in shell mode, I came across
<code>smie.el</code>, whose introductory comments include this gem:</p><blockquote><p>OTOH we had to kill many chickens, read many coffee grounds, and practice
untold numbers of black magic spells, to come up with the indentation code.
Since then, some of that code has been beaten into submission, but the
`smie-indent-keyword&rsquo; function is still pretty obscure.</p></blockquote><p>Even the <a href=https://www.gnu.org/software/emacs/manual/html_node/elisp/Auto_002dIndentation.html>GNU manual</a> speaks of it in the same way:</p><blockquote><p>Writing a good indentation function can be difficult and to a large extent it is
still a black art. Many major mode authors will start by writing a simple
indentation function that works for simple cases, for example by comparing with
the indentation of the previous text line. For most programming languages that
are not really line-based, this tends to scale very poorly: improving such a
function to let it handle more diverse situations tends to become more and more
difficult, resulting in the end with a large, complex, unmaintainable
indentation function which nobody dares to touch.</p></blockquote><h3 id=enable-horizontal-scrolling-with-mouse class="relative group">Enable horizontal scrolling with mouse <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enable-horizontal-scrolling-with-mouse aria-label=Anchor>#</a></span></h3><p>From a helpful <a href=https://stackoverflow.com/a/67758169>stackoverflow answer.</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>mouse-wheel-tilt-scroll</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=window-management class="relative group">Window management <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#window-management aria-label=Anchor>#</a></span></h3><p>From a Mickey Petersen <a href=https://www.masteringemacs.org/article/demystifying-emacs-window-manager>article</a>, this causes <code>switch-to-buffer</code> to open the
selected buffer in the current window rather than switching windows, assuming
both are open in the current frame. This is more frequently the behavior I
intend when I&rsquo;m trying to get a window to display a specific buffer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>version&lt;</span> <span class=nv>emacs-version</span> <span class=s>&#34;27.1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>switch-to-buffer-obey-display-actions</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=automatically-update-buffers-when-contents-change-on-disk class="relative group">Automatically update buffers when contents change on disk <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#automatically-update-buffers-when-contents-change-on-disk aria-label=Anchor>#</a></span></h3><p>Without setting <code>global-auto-revert-mode</code>, we have to remember to issue a
<code>revert-buffer</code> or <code>revert-buffer-quick</code> (<code>C-x x g</code> by default) in case a file
changed. Over Tramp, we still have to manually revert files when they&rsquo;ve
changed on disk.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-auto-revert-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=highlight-the-line-point-is-on class="relative group">Highlight the line point is on <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#highlight-the-line-point-is-on aria-label=Anchor>#</a></span></h3><p>Add a faint background highlight to the line we&rsquo;re editing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>hl-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>hl-line-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>hl-line-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=always-turn-on-flymake-in-prog-mode class="relative group">Always turn on flymake in prog mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#always-turn-on-flymake-in-prog-mode aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>flymake-mode</span><span class=p>)</span>
</span></span></code></pre></div><p>Another, related mode is <code>flyspell-prog-mode</code>, which is just checks spelling in
comments and strings.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>flyspell-prog-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=automatically-create-matching-parens-in-programming-modes class="relative group">Automatically create matching parens in programming modes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#automatically-create-matching-parens-in-programming-modes aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=p>(</span><span class=nv>electric-pair-mode</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=p>(</span><span class=nv>show-paren-mode</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=shorten-yes-no-prompts-to-y-n class="relative group">Shorten yes/no prompts to y/n <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#shorten-yes-no-prompts-to-y-n aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>use-short-answers</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=delete-whitespace-on-save class="relative group">Delete whitespace on save <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#delete-whitespace-on-save aria-label=Anchor>#</a></span></h3><p>I would also like to have a good-looking display for trailing whitespace and
leading tabs like in my Neovim setup, but it has proven challenging to just
narrow down to those two faces. In the interim, I toggle <code>M-x whitespace-mode</code> to
check for mixed tabs, spaces, and line endings.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;before-save-hook</span> <span class=ss>&#39;delete-trailing-whitespace</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=killing-buffers-with-a-running-process class="relative group">Killing buffers with a running process <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#killing-buffers-with-a-running-process aria-label=Anchor>#</a></span></h3><p>Typically, Emacs will ask you to confirm before killing a buffer that has a
running process, such as with <code>run-python</code>, a <code>*shell*</code> buffer, or a <code>*compilation*</code>
buffer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>kill-buffer-query-functions</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>remq</span> <span class=ss>&#39;process-kill-buffer-query-function</span>
</span></span><span class=line><span class=cl>         <span class=nv>kill-buffer-query-functions</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=don-t-wrap-lines class="relative group">Don&rsquo;t wrap lines <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#don-t-wrap-lines aria-label=Anchor>#</a></span></h3><p>I much prefer having long lines simply spill off to the right of the screen than
having them wrap around onto the next line, except in the case where I&rsquo;d like to
see wrapped line content, like in one of the shell modes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>truncate-lines</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;eshell-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>truncate-lines</span> <span class=no>nil</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;shell-mode-hook</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>truncate-lines</span> <span class=no>nil</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=relative-line-numbers class="relative group">Relative line numbers <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#relative-line-numbers aria-label=Anchor>#</a></span></h3><p>For programming and prose/writing modes.</p><p>Unfortunately, line numbers are displayed in the text area of the buffer, but
org-modern uses the fringe to display source blocks. <a href="https://www.reddit.com/r/emacs/comments/ymprwi/comment/iv5iafb/?utm_source=share&utm_medium=web2x&context=3">There&rsquo;s no way to display
them to the left</a> of the fringe, so I&rsquo;m careful about only turning on line
numbers in modes that I think I&rsquo;ll benefit from it. It&rsquo;s been working pretty
well in org-mode without the line numbers so far, since for each of the code
blocks I can always use <code>C-c '</code> to edit in <code>prog-mode</code>, where I <em>do</em> get line numbers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/display-relative-lines</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>display-line-numbers</span> <span class=ss>&#39;relative</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;prog-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/display-relative-lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;yaml-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/display-relative-lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>display-graphic-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;text-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/display-relative-lines</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=delete-region-when-we-yank-on-top-of-it class="relative group">Delete region when we yank on top of it <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#delete-region-when-we-yank-on-top-of-it aria-label=Anchor>#</a></span></h3><p>I just think that&rsquo;s a funny sentence. Normally when yanking text with an active
region, the region will remain and the yanked text is just inserted at point. I
prefer the modern word processor behavior of replacing the selected text with
the yanked content.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>delete-selection-mode</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=enable-mouse-in-terminal-tty class="relative group">Enable mouse in terminal/TTY <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enable-mouse-in-terminal-tty aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>xterm-mouse-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=compilation class="relative group">Compilation <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#compilation aria-label=Anchor>#</a></span></h3><p>As new text appears, the default behavior is for it to spill off the bottom,
unless we manually scroll to the end of the buffer. Instead, I prefer the
window to automatically scroll along with text as it appears, stopping at the
first error that appears.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>compilation-scroll-output</span> <span class=ss>&#39;first-error</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=tool-bar class="relative group">Tool bar <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tool-bar aria-label=Anchor>#</a></span></h3><p>I usually leave the tool bar disabled</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>tool-bar-mode</span> <span class=mi>-1</span><span class=p>)</span>
</span></span></code></pre></div><p>The <em>menu</em> bar, on the other hand <code>(menu-bar-mode)</code>, is very handy, and I only
disable it on Windows, where it looks hideous if I&rsquo;m running in dark mode.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>renz/windowsp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>menu-bar-mode</span> <span class=mi>-1</span><span class=p>))</span>
</span></span></code></pre></div><p>For newcomers to Emacs, I would strongly discourage disabling the menu bar, as
it is the most straightforward way to discover Emacs&rsquo; most useful features.</p><h3 id=ignore-risky-dot-dir-locals-dot-el class="relative group">Ignore risky .dir-locals.el <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ignore-risky-dot-dir-locals-dot-el aria-label=Anchor>#</a></span></h3><p>From an <a href=https://emacs.stackexchange.com/a/44604>Emacs stackexchange</a> answer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;risky-local-variable-p</span> <span class=nb>:override</span> <span class=nf>#&#39;</span><span class=nv>ignore</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=prefer-rg-over-grep class="relative group">Prefer <code>rg</code> over <code>grep</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#prefer-rg-over-grep aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;grep</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;rg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>grep-program</span> <span class=s>&#34;rg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>grep-apply-setting</span>
</span></span><span class=line><span class=cl>   <span class=ss>&#39;grep-find-command</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;rg -n -H --no-heading -e &#39;&#39; $(git rev-parse --show-toplevel || pwd)&#34;</span> <span class=o>.</span> <span class=mi>27</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=shorter-file-paths-in-grep-compilation-buffers class="relative group">Shorter file paths in grep/compilation buffers <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#shorter-file-paths-in-grep-compilation-buffers aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>scf-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>grep-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nv>scf-mode</span> <span class=mi>1</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=confirm-when-exiting-emacs class="relative group">Confirm when exiting Emacs <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#confirm-when-exiting-emacs aria-label=Anchor>#</a></span></h3><p>It&rsquo;s very annoying when I&rsquo;m working and suddenly I meant to do <code>C-c C-x</code>, but
instead hit <code>C-x C-c</code>. This helps prevent that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>confirm-kill-emacs</span> <span class=ss>&#39;yes-or-no-p</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=smooth-scrolling class="relative group">Smooth scrolling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#smooth-scrolling aria-label=Anchor>#</a></span></h3><p>Emacs 29 introduced smooth, pixel-level scrolling, which removes much of the
&ldquo;jumpiness&rdquo; you see when scrolling past images.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>version&lt;</span> <span class=nv>emacs-version</span> <span class=s>&#34;29.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>pixel-scroll-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pixel-scroll-precision-mode</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>pixel-scroll-precision-large-scroll-height</span> <span class=mf>35.0</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=prefer-aspell-over-ispell class="relative group">Prefer <code>aspell</code> over <code>ispell</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#prefer-aspell-over-ispell aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nv>executable-find</span> <span class=s>&#34;aspell&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ispell-program-name</span> <span class=s>&#34;aspell&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=backup-and-auto-save-files class="relative group">Backup and auto-save files <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#backup-and-auto-save-files aria-label=Anchor>#</a></span></h3><p>Keep all backup files in a temporary folder. At the moment I have some &ldquo;file
not found&rdquo; errors popping up during auto-save on Windows. Once I debug that,
I&rsquo;ll uncomment the second part.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>backup-directory-alist</span> <span class=o>&#39;</span><span class=p>((</span><span class=s>&#34;.&#34;</span> <span class=o>.</span> <span class=s>&#34;~/.emacs.d/backups/&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; auto-save-file-name-transforms &#39;((&#34;.&#34; ,temporary-file-directory t))</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span></code></pre></div><h3 id=enable-narrow-to-region class="relative group">Enable <code>narrow-to-region</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enable-narrow-to-region aria-label=Anchor>#</a></span></h3><p><code>narrow-to-region</code> restricts editing in this buffer to the current region. The
rest of the text becomes temporarily invisible and untouchable but is not
deleted; if you save the buffer in a file, the invisible text is included in the
file. <code>C-x n w</code> makes all visible again.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;narrow-to-region</span> <span class=ss>&#39;disabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=enable-up-downcase-region class="relative group">Enable up/downcase-region <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enable-up-downcase-region aria-label=Anchor>#</a></span></h3><p>Allows us to convert entire regions to upper or lower case.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;upcase-region</span> <span class=ss>&#39;disabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;downcase-region</span> <span class=ss>&#39;disabled</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=mark-rings-and-registers-bigger-faster-stronger class="relative group">Mark rings and registers: bigger, faster, stronger <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#mark-rings-and-registers-bigger-faster-stronger aria-label=Anchor>#</a></span></h3><p>16 is the default number of marks stored on the global and local mark rings
is 16. I hop around much more than 16 times as I&rsquo;m editing, so I expand this a
bit.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>mark-ring-max</span> <span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>global-mark-ring-max</span> <span class=mi>32</span><span class=p>)</span>
</span></span></code></pre></div><p>Another handy shortcut is continually popping marks by repeated <code>C-&lt;SPC></code> after
the first <code>C-u C-&lt;SPC></code> through the <code>set-mark-command-repeat-pop</code> setting.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>set-mark-command-repeat-pop</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>And, because I always forget it, to pop a global mark you use <code>C-x C-&lt;SPC></code>. The
local version, <code>C-u C-&lt;SPC></code> will only pop marks from the current buffer. So the
<code>C-x C-&lt;SPC></code> version is much closer to how Vim&rsquo;s jump stack works.</p><p>A handy &ldquo;bookmark&rdquo; system (aside from actual bookmarks) is to set common buffers
and files to registers pre-emptively.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>set-register</span> <span class=sc>?S</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>buffer</span> <span class=o>.</span> <span class=s>&#34;*scratch*&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-register</span> <span class=sc>?I</span> <span class=o>`</span><span class=p>(</span><span class=nv>file</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>expand-file-name</span> <span class=s>&#34;README.org&#34;</span> <span class=nv>user-emacs-directory</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>set-register</span> <span class=sc>?B</span> <span class=o>`</span><span class=p>(</span><span class=nv>file</span> <span class=o>.</span> <span class=s>&#34;~/.bashrc&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>The default keybinding for <code>jump-to-register</code> is <code>C-x r j R</code>, where <code>R</code> is the name of
the register. My own personal convention here is to use lower-case letter for
interactive session bookmarks that will be lost between sessions, and upper-case
letters for ones I&rsquo;ve set permanently here.</p><p>Before I was aware of this feature I had created my own <code>jump-to-X</code> style
functions, but this is much better! You even get a handy pop-up if you wait a
second after typing <code>C-x r j</code> to see all the available registers.</p><h2 id=keybindings class="relative group">Keybindings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#keybindings aria-label=Anchor>#</a></span></h2><h3 id=expanded-better-defaults class="relative group">Expanded/better defaults <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#expanded-better-defaults aria-label=Anchor>#</a></span></h3><p>These convenient chords allow for fast text replacement by holding <code>C-M-</code> and
rapidly typing <code>k</code> and <code>h</code> in succession.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-M-&lt;backspace&gt;&#34;</span><span class=p>)</span> <span class=ss>&#39;backward-kill-sexp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-M-h&#34;</span><span class=p>)</span> <span class=ss>&#39;backward-kill-sexp</span><span class=p>)</span>
</span></span></code></pre></div><p>The next line UNBINDS the suspend-frame keybinding. Accidentally minimizing on
the GUI was frustrating as hell, so now I use <code>C-x C-z</code> if I <em>really</em> want to
suspend the frame.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-z&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>zap-up-to-char</span><span class=p>)</span>
</span></span></code></pre></div><p>Hippie-expand <a href=https://www.masteringemacs.org/article/text-expansion-hippie-expand>is purported</a> to be a better version of <code>dabbrev</code>, but I rather like
the default behavior of <code>dabbrev</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>dabbrev-expand</span><span class=p>]</span> <span class=ss>&#39;hippie-expand</span><span class=p>)</span>
</span></span></code></pre></div><p><code>ibuffer</code> is a strictly superior, built-in version of its counterpart.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>[</span><span class=nv>remap</span> <span class=nv>list-buffers</span><span class=p>]</span> <span class=ss>&#39;ibuffer</span><span class=p>)</span>
</span></span></code></pre></div><p>The most common situation where I&rsquo;m running <code>flymake</code> would be for spelling in
prose, or diagnostics from a language server. In either case, I like having
next/previous on easy to reach chords.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>flymake</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=nb>:map</span> <span class=nv>flymake-mode-map</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c n&#34;</span> <span class=o>.</span> <span class=nv>flymake-goto-next-error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c p&#34;</span> <span class=o>.</span> <span class=nv>flymake-goto-prev-error</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=overriding-defaults class="relative group">Overriding defaults <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#overriding-defaults aria-label=Anchor>#</a></span></h3><p>Some default bindings aren&rsquo;t useful for me, so I bind them to actions I take
more frequently.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-p&#34;</span><span class=p>)</span> <span class=ss>&#39;previous-buffer</span><span class=p>)</span>  <span class=c1>; Overrides `mark-page&#39;</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x C-n&#34;</span><span class=p>)</span> <span class=ss>&#39;next-buffer</span><span class=p>)</span>      <span class=c1>; Overrides `set-goal-column&#39;</span>
</span></span></code></pre></div><h3 id=c-c-bindings class="relative group">C-c bindings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-bindings aria-label=Anchor>#</a></span></h3><p>Emacs has <a href=https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Bindings.html>some standards</a> about where user-configured keys should go; <code>C-c &lt;letter></code> is always free for users. It may seem like overkill how I set a header
for each possible <code>C-c</code> combination, but it&rsquo;s incredibly handy when I want to jump
directly to one of these headings while in another buffer. See e.g. <code>org-goto</code>,
which allows me to narrow in on a particular key I&rsquo;d like to bind by leveraging
<code>completing-read</code>. If a <code>C-c &lt;letter></code> combination is missing as a header, then I&rsquo;m
probably using it in a <code>:bind</code> statement with <code>use-package</code> somewhere else.</p><h4 id=c-c-b-build-compile class="relative group"><code>C-c b</code> build / compile <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-b-build-compile aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c b&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>compile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c B&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>recompile</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-c-calendar class="relative group"><code>C-c c</code> Calendar <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-c-calendar aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c c&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>calendar</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-d-navigating-to-symbols-using-old-school-tags class="relative group"><code>C-c d</code> Navigating to symbols using old-school TAGS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-d-navigating-to-symbols-using-old-school-tags aria-label=Anchor>#</a></span></h4><p>Before the whole language server revolution, we had TAGS files for caching the
location of symbol definitions. <code>etags</code> comes with Emacs, and combining some
clever use of <code>find</code> with it can render a pretty good symbol search experience.
To generate the TAGS file, I usually have a <code>TAGS</code> recipe that looks something
similar to this in each project&rsquo;s <code>Makefile</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>find . -type d -name <span class=s2>&#34;.venv&#34;</span> -prune <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type d -name <span class=s2>&#34;.ipynb_checkpoints&#34;</span> -prune <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type d -name <span class=s2>&#34;.node_modules&#34;</span> -prune <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type d -name <span class=s2>&#34;elpa&#34;</span> -prune <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type f -name <span class=s2>&#34;*.py&#34;</span> -print <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type f -name <span class=s2>&#34;*.sql&#34;</span> -print <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -o -type f -name <span class=s2>&#34;*.el&#34;</span> -print <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=p>|</span> etags -
</span></span></code></pre></div><p>Then, <code>M-x project-compile RET make TAGS</code> builds a tags table. At which point, I
can use <code>tags-completion-table</code> to build a list of symbols I can navigate to with
completion, with just a little help from <code>xref-find-definitions</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/find-tag</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Use </span><span class=ss>`completing-read&#39;</span><span class=s> to navigate to a tag.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;etags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>tags-completion-table</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>xref-find-definitions</span> <span class=p>(</span><span class=nf>completing-read</span> <span class=s>&#34;Find tag: &#34;</span> <span class=nv>tags-completion-table</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c d&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>renz/find-tag</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-f-find-file-at-point--ffap class="relative group"><code>C-c f</code> find file at point (ffap) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-f-find-file-at-point--ffap aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c f&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>ffap</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-j-toggle-window-split class="relative group"><code>C-c j</code> Toggle window split <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-j-toggle-window-split aria-label=Anchor>#</a></span></h4><p><a href=https://www.emacswiki.org/emacs/ToggleWindowSplit>Toggling windows</a> from vertical to horizontal splits and vice-versa.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>toggle-window-split</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Switch between horizontal and vertical split window layout.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>count-windows</span><span class=p>)</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>this-win-buffer</span> <span class=p>(</span><span class=nf>window-buffer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>next-win-buffer</span> <span class=p>(</span><span class=nf>window-buffer</span> <span class=p>(</span><span class=nf>next-window</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>this-win-edges</span> <span class=p>(</span><span class=nf>window-edges</span> <span class=p>(</span><span class=nf>selected-window</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>next-win-edges</span> <span class=p>(</span><span class=nf>window-edges</span> <span class=p>(</span><span class=nf>next-window</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>this-win-2nd</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>&lt;=</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>this-win-edges</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                         <span class=p>(</span><span class=nf>car</span> <span class=nv>next-win-edges</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                                     <span class=p>(</span><span class=nf>&lt;=</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>this-win-edges</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                         <span class=p>(</span><span class=nv>cadr</span> <span class=nv>next-win-edges</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>splitter</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>this-win-edges</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nf>window-edges</span> <span class=p>(</span><span class=nf>next-window</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;split-window-horizontally</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;split-window-vertically</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>delete-other-windows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>let</span> <span class=p>((</span><span class=nv>first-win</span> <span class=p>(</span><span class=nf>selected-window</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>funcall</span> <span class=nv>splitter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=nv>this-win-2nd</span> <span class=p>(</span><span class=nv>other-window</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>set-window-buffer</span> <span class=p>(</span><span class=nf>selected-window</span><span class=p>)</span> <span class=nv>this-win-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>set-window-buffer</span> <span class=p>(</span><span class=nf>next-window</span><span class=p>)</span> <span class=nv>next-win-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>select-window</span> <span class=nv>first-win</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>if</span> <span class=nv>this-win-2nd</span> <span class=p>(</span><span class=nv>other-window</span> <span class=mi>1</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c j&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>toggle-window-split</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-k-kill-all-but-one-space class="relative group"><code>C-c k</code> kill all but one space <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-k-kill-all-but-one-space aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c k&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>just-one-space</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-q-replace-regexp class="relative group"><code>C-c q</code> replace regexp <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-q-replace-regexp aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c q&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>replace-regexp</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-r-find-recent-files class="relative group"><code>C-c r</code> find recent files <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-r-find-recent-files aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c r&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>renz/find-recent-file</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-s-shell class="relative group"><code>C-c s</code> shell <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-s-shell aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c s s&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>shell</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c s e&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>eshell</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c s t&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>term</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-u-open-url-at-point-in-browser class="relative group"><code>C-c u</code> open URL at point in browser <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-u-open-url-at-point-in-browser aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c u&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>browse-url-at-point</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-v-faster-git-commit class="relative group"><code>C-c v</code> faster git-commit <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-v-faster-git-commit aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/git-commit</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>vc-next-action</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>log-edit-show-diff</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>other-window</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c v&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>renz/git-commit</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-w-whitespace-mode class="relative group"><code>C-c w</code> whitespace mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-w-whitespace-mode aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c w&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>whitespace-mode</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=c-c-other-bindings class="relative group"><code>C-c</code> Other bindings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#c-c-other-bindings aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c &lt;DEL&gt;&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>backward-kill-sexp</span><span class=p>)</span>  <span class=c1>;; TTY-frindly</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-c &lt;SPC&gt;&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>mark-sexp</span><span class=p>)</span>  <span class=c1>;; TTY-friendly</span>
</span></span></code></pre></div><h3 id=f5-f9 class="relative group">F5-F9 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#f5-f9 aria-label=Anchor>#</a></span></h3><p>Like the <code>C-c &lt;letter></code> bindings, these are reserved for users. In practice, even
though there are few of these keys, I tend to forget which is which. So I wind
up using things bound to my <code>C-c</code> keymaps instead. The <code>C-c</code> kyes from a more
natural, nested language in my head, so it feels more like I&rsquo;m &ldquo;speaking Emacs&rdquo;
that way.</p><h3 id=super-bindings class="relative group">Super bindings <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#super-bindings aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>global-set-key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;s-p&#34;</span><span class=p>)</span> <span class=nf>#&#39;</span><span class=nv>project-switch-project</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=text-completion class="relative group">Text Completion <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#text-completion aria-label=Anchor>#</a></span></h2><p>Emacs offers incredible depth and freedom when configuring methods to
automatically complete text. There are actually two things that
&ldquo;autocompletion&rdquo; can refer to in Emacs:</p><ol><li><a href=https://www.gnu.org/software/emacs/manual/html_node/emacs/Completion.html>Minibuffer completion</a></li><li><a href=https://www.gnu.org/software/emacs/manual/html_node/elisp/Completion-in-Buffers.html>Completion at point</a></li></ol><p>Emacs on its own does not have a nice pop-up-menu like Vim for completing text
at point. For both the minibuffer and <code>completion-at-point</code> it uses a special
buffer called <code>*Completions*</code>, from which we can see (and optionally select) a
completion from potential candidates. Before we get to tweak those settings,
though, we first need to oil the engine with an enhanced <em>completion style</em></p><h3 id=completion-style-orderless class="relative group">Completion style: Orderless <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#completion-style-orderless aria-label=Anchor>#</a></span></h3><p>For both the minibuffer and <code>completion-at-point</code>, I use the same <em>completion
style</em>. Completion style is the method of assigning completion candidates to a
given input string. <code>flex</code> is the built-in &ldquo;fuzzy&rdquo; completion style, familiar to
us from symbol completion in IDEs and VSCode&rsquo;s command palette. <code>basic</code> functions
much like your default TAB-complete at a Bash shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>flex</span> <span class=nv>basic</span> <span class=nv>partial-completion</span> <span class=nv>emacs22</span><span class=p>))</span>
</span></span></code></pre></div><p>I&rsquo;ve found the <a href=https://github.com/oantolin/orderless>orderless</a> completion style especially well-suited to Emacs. It
allows me to type short strings that can match the symbol I&rsquo;m looking for in any
order. In Emacs, I may not know if I&rsquo;m looking for <code>package-list</code> or
<code>list-packages</code>. In either case, I can just type &ldquo;<code>pack lis</code>&rdquo; in the minibuffer to
find the correct one.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>orderless</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;completion-styles</span> <span class=ss>&#39;orderless</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>orderless-component-separator</span> <span class=s>&#34;[ &amp;]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>completion-category-overrides</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>file</span> <span class=p>(</span><span class=nv>styles</span> <span class=nv>basic</span> <span class=nv>partial-completion</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=nicer-display-and-behavior-of-completions class="relative group">Nicer Display and Behavior of <code>*Completions*</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#nicer-display-and-behavior-of-completions aria-label=Anchor>#</a></span></h3><p>With the <em>completion style</em> set, we now have to configure the interface for
<em>displaying</em> candidates as we type. First, I want candidates displayed as a
single, vertical list.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>completions-format</span> <span class=ss>&#39;one-column</span><span class=p>)</span>
</span></span></code></pre></div><p>Also, when using the built-in completion-at-point, the <code>*Completions*</code> buffer can
sometimes take up the whole screen when there are a lot of candidates.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>version&lt;</span> <span class=nv>emacs-version</span> <span class=s>&#34;29.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>completions-max-height</span> <span class=mi>15</span><span class=p>))</span>
</span></span></code></pre></div><p>Some time ago, Prot wrote a package called <a href=https://github.com/protesilaos/mct/blob/main/mct.el>MCT</a> (Minibuffer and Completions in
Tandem) that enhanced the default minibuffer and <code>*Completions*</code> buffer behavior
to act more like what we expect of a modern editor&rsquo;s auto-complete. He
discontinued development of that project once it became clear that Emacs 29 was
going to include similar behavior as a configurable option. These are the
options in question.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>version&lt;</span> <span class=nv>emacs-version</span> <span class=s>&#34;29.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>completion-auto-help</span> <span class=ss>&#39;visible</span>
</span></span><span class=line><span class=cl>        <span class=nv>completion-auto-select</span> <span class=ss>&#39;second-tab</span>
</span></span><span class=line><span class=cl>        <span class=nv>completion-show-help</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>completions-sort</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>completions-header-format</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><p>Another nice addition to Emacs 29 is the option to sort completion candidates
with any supplied function. Below is one example provided by Prot, which
prioritzes history, followed by lexicographical order, then length.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sort-by-alpha-length</span> <span class=p>(</span><span class=nv>elems</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Sort ELEMS first alphabetically, then by length.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>sort</span> <span class=nv>elems</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=nv>c1</span> <span class=nv>c2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nb>or</span> <span class=p>(</span><span class=nv>string-version-lessp</span> <span class=nv>c1</span> <span class=nv>c2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>c1</span><span class=p>)</span> <span class=p>(</span><span class=nf>length</span> <span class=nv>c2</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sort-by-history</span> <span class=p>(</span><span class=nv>elems</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Sort ELEMS by minibuffer history.
</span></span></span><span class=line><span class=cl><span class=s>Use </span><span class=ss>`mct-sort-sort-by-alpha-length&#39;</span><span class=s> if no history is available.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>if-let</span> <span class=p>((</span><span class=nv>hist</span> <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>minibuffer-history-variable</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nf>symbol-value</span> <span class=nv>minibuffer-history-variable</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>minibuffer--sort-by-position</span> <span class=nv>hist</span> <span class=nv>elems</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>renz/sort-by-alpha-length</span> <span class=nv>elems</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/completion-category</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return completion category.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>when-let</span> <span class=p>((</span><span class=nv>window</span> <span class=p>(</span><span class=nf>active-minibuffer-window</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>with-current-buffer</span> <span class=p>(</span><span class=nf>window-buffer</span> <span class=nv>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>completion-metadata-get</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>completion-metadata</span> <span class=p>(</span><span class=nf>buffer-substring-no-properties</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nf>minibuffer-prompt-end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=nf>max</span> <span class=p>(</span><span class=nf>minibuffer-prompt-end</span><span class=p>)</span> <span class=p>(</span><span class=nf>point</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                            <span class=nv>minibuffer-completion-table</span>
</span></span><span class=line><span class=cl>                            <span class=nv>minibuffer-completion-predicate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=ss>&#39;category</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sort-multi-category</span> <span class=p>(</span><span class=nv>elems</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Sort ELEMS per completion category.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>pcase</span> <span class=p>(</span><span class=nv>renz/completion-category</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;nil</span> <span class=nv>elems</span><span class=p>)</span> <span class=c1>; no sorting</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;kill-ring</span> <span class=nv>elems</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=ss>&#39;project-file</span> <span class=p>(</span><span class=nv>renz/sort-by-alpha-length</span> <span class=nv>elems</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>_</span> <span class=p>(</span><span class=nv>renz/sort-by-history</span> <span class=nv>elems</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>version&lt;</span> <span class=nv>emacs-version</span> <span class=s>&#34;29.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>completions-sort</span> <span class=nf>#&#39;</span><span class=nv>renz/sort-multi-category</span><span class=p>))</span>
</span></span></code></pre></div><p>Ideally, I would have a function that prioritizes based on <em>relevance</em>, which is
not always a trivial algorithm.</p><p>What all of the above form isn&rsquo;t <em>quite</em> the live-updating version that <a href=https://github.com/oantolin/live-completions>Oantolnin</a>,
MCT, or vertico offer, but it&rsquo;s pretty close. The <code>*Completions*</code> buffer updates
after every <code>&lt;SPC></code>, which is the natural filtering mechanism for <code>orderless</code>.</p><h3 id=completion-at-point class="relative group">Completion at point <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#completion-at-point aria-label=Anchor>#</a></span></h3><p>By default, Emacs uses <code>M-TAB</code>, or the equivalent <code>C-M-i</code> for <code>completion-at-point</code>.
I&rsquo;d much prefer to use the easier and more intuitive <code>TAB</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-always-indent</span> <span class=ss>&#39;complete</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=corfu-and-vertico class="relative group"><code>corfu</code> and <code>vertico</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#corfu-and-vertico aria-label=Anchor>#</a></span></h3><p>When I was using <code>corfu</code> and <code>vertico</code>, I did some hacking on it to optimize for
<code>orderless</code>, as well as some &ldquo;tab-n-go&rdquo; style configuration. This is here as a
vestige of days past, but good as a reference if I ever wanted to go back.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>corfu</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp/corfu&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:disabled</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:demand</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>:map</span> <span class=nv>corfu-map</span>
</span></span><span class=line><span class=cl>        <span class=c1>;; (&#34;SPC&#34; . corfu-insert-separator)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s>&#34;TAB&#34;</span> <span class=o>.</span> <span class=nv>corfu-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>([</span><span class=nv>tab</span><span class=p>]</span> <span class=o>.</span> <span class=nv>corfu-next</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s>&#34;S-TAB&#34;</span> <span class=o>.</span> <span class=nv>corfu-previous</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>([</span><span class=nv>backtab</span><span class=p>]</span> <span class=o>.</span> <span class=nv>corfu-previous</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>corfu-auto</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>corfu-auto-delay</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>corfu-auto-prefix</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>completion-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless-fast</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>corfu-enable-in-minibuffer</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Enable Corfu in the minibuffer if </span><span class=ss>`completion-at-point&#39;</span><span class=s> is bound.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>where-is-internal</span> <span class=nf>#&#39;</span><span class=nv>completion-at-point</span> <span class=p>(</span><span class=nf>list</span> <span class=p>(</span><span class=nf>current-local-map</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-auto</span> <span class=no>nil</span><span class=p>)</span> <span class=c1>;; Enable/disable auto completion</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>corfu-echo-delay</span> <span class=no>nil</span> <span class=c1>;; Disable automatic echo and popup</span>
</span></span><span class=line><span class=cl>                  <span class=nv>corfu-popupinfo-delay</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>corfu-mode</span> <span class=mi>1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>orderless-fast-dispatch</span> <span class=p>(</span><span class=nv>word</span> <span class=nv>index</span> <span class=nv>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>and</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>index</span> <span class=mi>0</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>total</span> <span class=mi>1</span><span class=p>)</span> <span class=p>(</span><span class=nv>length&lt;</span> <span class=nv>word</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=o>`</span><span class=p>(</span><span class=nv>orderless-regexp</span> <span class=o>.</span> <span class=o>,</span><span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;^&#34;</span> <span class=p>(</span><span class=nf>regexp-quote</span> <span class=nv>word</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>orderless-define-completion-style</span> <span class=nv>orderless-fast</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>orderless-style-dispatchers</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless-fast-dispatch</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>orderless-matching-styles</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>orderless-literal</span> <span class=nv>orderless-regexp</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;minibuffer-setup-hook</span> <span class=nf>#&#39;</span><span class=nv>corfu-enable-in-minibuffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>global-corfu-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>vertico</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp/vertico&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:disabled</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>vertico-mode</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=language-specific-major-modes class="relative group">Language-specific major modes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#language-specific-major-modes aria-label=Anchor>#</a></span></h2><h3 id=shell--bash-sh-dot-dot-dot class="relative group">Shell (Bash, sh, &mldr;) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#shell--bash-sh-dot-dot-dot aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sh-indentation</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (setq indent-tabs-mode t)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-width</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;sh-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/sh-indentation</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;bash-ts-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/sh-indentation</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=css class="relative group">CSS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#css aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>css-indent-offset</span> <span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></div><p>For validation, grab <a href=https://github.com/w3c/css-validator/releases/download/cssval-20220105/css-validator.jar>css-validator.jar</a> and execute it with java:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>java -jar ~/.local/jars/css-validator.jar file:///home/me/my/site/index.html
</span></span></code></pre></div><h3 id=org-mode class="relative group">Org-mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#org-mode aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>renz/org-home</span> <span class=s>&#34;~/.emacs.d/org/&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><code>org-mode</code> provides <code>org-babel-tangle-jump-to-org</code>, which jumps back to an Org
source file from within the tangled code. <code>renz/org-babel-tangle-jump-to-src</code>,
defined below, does the opposite - given the Org source file and point inside a
<code>src</code> block, it jumps to the location of the tangled code. Provided by a helpful
<a href=https://emacs.stackexchange.com/a/69591>stackoverflow answer.</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/org-babel-tangle-jump-to-src</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;The opposite of </span><span class=ss>`org-babel-tangle-jump-to-org&#39;</span><span class=s>.
</span></span></span><span class=line><span class=cl><span class=s>Jumps to an Org src block from tangled code.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>org-in-src-block-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>let*</span> <span class=p>((</span><span class=nv>header</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nv>org-babel-tangle-single-block</span> <span class=mi>1</span> <span class=ss>&#39;only-this-block</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>tangle</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>header</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>lang</span> <span class=p>(</span><span class=nv>caadr</span> <span class=nv>header</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>buffer</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>header</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>org-id</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>header</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>source-name</span> <span class=p>(</span><span class=nf>nth</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>cadr</span> <span class=nv>header</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>search-comment</span> <span class=p>(</span><span class=nv>org-fill-template</span>
</span></span><span class=line><span class=cl>                              <span class=nv>org-babel-tangle-comment-format-beg</span>
</span></span><span class=line><span class=cl>                              <span class=o>`</span><span class=p>((</span><span class=s>&#34;link&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=nv>org-id</span><span class=p>)</span> <span class=p>(</span><span class=s>&#34;source-name&#34;</span> <span class=o>.</span> <span class=o>,</span><span class=nv>source-name</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>file</span> <span class=p>(</span><span class=nf>expand-file-name</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nv>org-babel-effective-tangled-filename</span> <span class=nv>buffer</span> <span class=nv>lang</span> <span class=nv>tangle</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>not</span> <span class=p>(</span><span class=nf>file-exists-p</span> <span class=nv>file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;File does not exist. &#39;org-babel-tangle&#39; first to create file.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>find-file</span> <span class=nv>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>beginning-of-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>search-forward</span> <span class=nv>search-comment</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Cannot jump to tangled file because point is not at org src block.&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><p>Now we configure <code>org-mode</code> itself. For a while I was trying <code>(setq org-startup-indented t)</code> to get indentation under each header, but this was
interfering with the beautification features from <code>org-modern</code>. Preferring the
latter over the former, I&rsquo;ve removed the <code>org-startup-indented</code> call.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/list-files-with-absolute-path</span> <span class=p>(</span><span class=nv>directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Return a list of files in DIRECTORY with their absolute paths.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>cl-remove-if-not</span> <span class=nf>#&#39;file-regular-p</span> <span class=p>(</span><span class=nf>directory-files</span> <span class=nv>directory</span> <span class=no>t</span> <span class=s>&#34;.*\.org$&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span>
</span></span><span class=line><span class=cl>  <span class=p>((</span><span class=nv>org-mode</span> <span class=o>.</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>()</span> <span class=p>(</span><span class=nb>progn</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;after-save-hook</span> <span class=nf>#&#39;</span><span class=nv>org-babel-tangle</span> <span class=nb>:append</span> <span class=nb>:local</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;org-babel-after-execute-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/display-ansi-colors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nb>setq</span> <span class=nv>indent-tabs-mode</span> <span class=no>nil</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/jump-org</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Prompt for an org file in my emacs directory, then go there.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>renz/--jump-section</span> <span class=nv>renz/org-home</span> <span class=s>&#34;Org files: &#34;</span> <span class=s>&#34;.*\.org$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span>
</span></span><span class=line><span class=cl>  <span class=p>((</span><span class=s>&#34;C-c o a&#34;</span> <span class=o>.</span> <span class=nv>org-agenda</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o b d&#34;</span> <span class=o>.</span> <span class=nv>org-babel-detangle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o b o&#34;</span> <span class=o>.</span> <span class=nv>org-babel-tangle-jump-to-org</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o b s&#34;</span> <span class=o>.</span> <span class=nv>renz/org-babel-tangle-jump-to-src</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o k&#34;</span> <span class=o>.</span> <span class=nv>org-babel-remove-result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o o&#34;</span> <span class=o>.</span> <span class=nv>renz/jump-org</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c o y&#34;</span> <span class=o>.</span> <span class=nv>ox-clip-image-to-clipboard</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-image-actual-width</span> <span class=no>nil</span> <span class=s>&#34;Enable resizing of images&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-agenda-files</span> <span class=p>(</span><span class=nv>renz/list-files-with-absolute-path</span> <span class=nv>renz/org-home</span><span class=p>)</span> <span class=s>&#34;Sources for Org agenda view&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-html-htmlize-output-type</span> <span class=no>nil</span> <span class=s>&#34;See C-h f org-html-htmlize-output-type&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-confirm-babel-evaluate</span> <span class=no>nil</span> <span class=s>&#34;Don&#39;t ask for confirmation when executing src blocks&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-edit-src-content-indentation</span> <span class=mi>2</span> <span class=s>&#34;Indent all src blocks by this much&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-goto-interface</span> <span class=ss>&#39;outline-path-completion</span> <span class=s>&#34;Use completing-read for org-goto (C-c C-j, nicer than imenu)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-outline-path-complete-in-steps</span> <span class=no>nil</span> <span class=s>&#34;Flatten the outline path, instead of completing hierarchically&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;org-modules</span> <span class=ss>&#39;org-tempo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-babel-do-load-languages</span>
</span></span><span class=line><span class=cl>   <span class=ss>&#39;org-babel-load-languages</span>
</span></span><span class=line><span class=cl>   <span class=o>&#39;</span><span class=p>((</span><span class=nv>emacs-lisp</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>python</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>sql</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>shell</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>R</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (fortran . t)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>julia</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (jupyter . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (scheme . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (haskell . t)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nv>lisp</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (clojure . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (C . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (org . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (gnuplot . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (awk . t)</span>
</span></span><span class=line><span class=cl>     <span class=c1>;; (latex . t)</span>
</span></span><span class=line><span class=cl>     <span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-babel class="relative group">Org babel <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#org-babel aria-label=Anchor>#</a></span></h4><p>For literate programming. <code>ob-async</code> allows us to execute a block without waiting for it to finish.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ob-async</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>ob-async-no-async-languages-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;ipython&#34;</span> <span class=s>&#34;python&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=org-modern class="relative group"><code>org-modern</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#org-modern aria-label=Anchor>#</a></span></h4><p>A <a href=https://github.com/minad/org-modern>lovely look</a> for <code>org-mode</code> by minad.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>org-modern</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-auto-align-tags</span> <span class=no>nil</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-tags-column</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-catch-invisible-edits</span> <span class=ss>&#39;show-and-error</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-special-ctrl-a/e</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-insert-heading-respect-content</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>;; Org styling, hide markup etc.</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-hide-emphasis-markers</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-pretty-entities</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-ellipsis</span> <span class=s>&#34;…&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>;; Agenda styling</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-agenda-tags-column</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-agenda-block-separator</span> <span class=sc>?─</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-agenda-time-grid</span> <span class=o>&#39;</span><span class=p>((</span><span class=nv>daily</span> <span class=nv>today</span> <span class=nv>require-timed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=p>(</span><span class=mi>800</span> <span class=mi>1000</span> <span class=mi>1200</span> <span class=mi>1400</span> <span class=mi>1600</span> <span class=mi>1800</span> <span class=mi>2000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                               <span class=s>&#34; ┄┄┄┄┄ &#34;</span> <span class=s>&#34;┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-agenda-current-time-string</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;&lt;─ now ────────────────────────────────────────────────&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>display-graphic-p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-modern-table</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-modern-table</span> <span class=no>nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>global-org-modern-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=copying-images-out-of-org-babel class="relative group">Copying images out of org-babel <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#copying-images-out-of-org-babel aria-label=Anchor>#</a></span></h4><p>Offers two functions:</p><ul><li><code>ox-clip-formatted-copy</code></li><li><code>ox-clip-image-to-clipboard</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-clip</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>org-hugo-front-matter-format</span> <span class=s>&#34;yaml&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=exporting-to-hugo class="relative group">Exporting to Hugo <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#exporting-to-hugo aria-label=Anchor>#</a></span></h4><p>I also use <code>org-mode</code> for writing <a href=https://robbmann.io/posts>my blog.</a> With a little help from <a href=https://willschenk.com/articles/2019/using_org_mode_in_hugo/>an article</a> we
have exporting to Hugo-specific markdown. Without the export, Hugo can read Org
files <em>okay-ish</em>, but you wind up missing some nice QoL features, like header
links.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>ox-hugo</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=converting-json-to-org-tables class="relative group">Converting JSON to Org Tables <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#converting-json-to-org-tables aria-label=Anchor>#</a></span></h4><p>I use a small external dependency for this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>json-to-org-table</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp/json-to-org-table/&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=nv>org</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=sql class="relative group">SQL <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#sql aria-label=Anchor>#</a></span></h3><h4 id=ddl-is-sql class="relative group">DDL is SQL <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ddl-is-sql aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.ddl\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>sql-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.bql\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>sql-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=indentation class="relative group">Indentation <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#indentation aria-label=Anchor>#</a></span></h4><p>Vanilla Emacs doesn&rsquo;t offer a lot (read: nothing) in terms of making SQL code
pretty. I tend to format SQL like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>whatever</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>thing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>wherever</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>w</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>the_other</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>w</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>whatever</span><span class=w>
</span></span></span></code></pre></div><p>The configuration of <code>sql-indent</code> below achieves that nicely when using <code>RET</code> and
<code>TAB</code> for formatting.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sql-mode-hook</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>tab-width</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defvar</span> <span class=nv>renz/sql-indentation-offsets-alist</span>
</span></span><span class=line><span class=cl>  <span class=o>&#39;</span><span class=p>((</span><span class=nv>syntax-error</span> <span class=nv>sqlind-report-sytax-error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-string</span> <span class=nv>sqlind-report-runaway-string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>comment-continuation</span> <span class=nv>sqlind-indent-comment-continuation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>comment-start</span> <span class=nv>sqlind-indent-comment-start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>toplevel</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-block</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-begin-block</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>block-start</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>block-end</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>declare-statement</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>package</span> <span class=nv>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>package-body</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>create-statement</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>defun-start</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>labeled-statement-start</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>statement-continuation</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>nested-statement-open</span> <span class=nv>sqlind-use-anchor-indentation</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>nested-statement-continuation</span> <span class=nv>sqlind-use-previous-line-indentation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>nested-statement-close</span> <span class=nv>sqlind-use-anchor-indentation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>with-clause</span> <span class=nv>sqlind-use-anchor-indentation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>with-clause-cte</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>with-clause-cte-cont</span> <span class=nv>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>case-clause</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>case-clause-item</span> <span class=nv>sqlind-use-anchor-indentation</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>case-clause-item-cont</span> <span class=nv>sqlind-right-justify-clause</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-clause</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-column</span> <span class=nv>sqlind-indent-select-column</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-column-continuation</span> <span class=nv>sqlind-indent-select-column</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-join-condition</span> <span class=nv>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-table</span> <span class=nv>sqlind-indent-select-table</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>select-table-continuation</span> <span class=nv>sqlind-indent-select-table</span> <span class=nf>+</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-select-clause</span> <span class=nv>sqlind-lineup-to-clause-end</span> <span class=nv>sqlind-right-justify-logical-operator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>insert-clause</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-insert-clause</span> <span class=nv>sqlind-lineup-to-clause-end</span> <span class=nv>sqlind-right-justify-logical-operator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>delete-clause</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-delete-clause</span> <span class=nv>sqlind-lineup-to-clause-end</span> <span class=nv>sqlind-right-justify-logical-operator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>update-clause</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>in-update-clause</span> <span class=nv>sqlind-lineup-to-clause-end</span> <span class=nv>sqlind-right-justify-logical-operator</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/sql-indentation-offsets</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sqlind-indentation-offsets-alist</span>
</span></span><span class=line><span class=cl>        <span class=nv>renz/sql-indentation-offsets-alist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>sqlind-basic-offset</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>sql-indent</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>sqlind-minor-mode</span> <span class=o>.</span> <span class=nv>renz/sql-indentation-offsets</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>sql-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>sql-mode</span> <span class=o>.</span> <span class=nv>renz/sql-mode-hook</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>sql-mode</span> <span class=o>.</span> <span class=nv>sqlup-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>sql-mode</span> <span class=o>.</span> <span class=nv>sqlind-minor-mode</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=interactive-hive2-mode class="relative group">Interactive <code>hive2</code> mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#interactive-hive2-mode aria-label=Anchor>#</a></span></h4><p>This &ldquo;hive2&rdquo; package came from the days where I was working on an on-prem system
that used <code>hive2</code> as the main command-line interface to Hive. I don&rsquo;t use this
much now, but it&rsquo;s a good reference for implementing a plug-in to a new
interactive SQL CLI.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>hive2</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp/&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:demand</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=p>(</span><span class=s>&#34;\\.hql&#34;</span> <span class=o>.</span> <span class=nv>sql-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=interactive-bq-shell class="relative group">Interactive <code>bq shell</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#interactive-bq-shell aria-label=Anchor>#</a></span></h4><p>The SQL interactive commands are looking for a single executable file, so let&rsquo;s
set that up somewhere common.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/usr/bin/env sh
</span></span></span><span class=line><span class=cl><span class=cp></span>bq shell <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>Also, we don&rsquo;t want to use &ldquo;legacy SQL&rdquo; in our queries, which requires us to
configure the <code>bq query</code> statically in a <code>~/.bigqueryrc</code> file, according to the
Google <a href=https://issuetracker.google.com/issues/35905841>issue tracker</a>.</p><pre tabindex=0><code class=language-:tangle data-lang=:tangle>[query]
--use_legacy_sql=false
</code></pre><p>Then enable the BQ product.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>bq</span>
</span></span><span class=line><span class=cl>  <span class=nb>:load-path</span> <span class=s>&#34;site-lisp&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>:demand</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=bigquery-sql-blocks-in-org-babel class="relative group">BigQuery <code>sql</code> Blocks in Org-Babel <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bigquery-sql-blocks-in-org-babel aria-label=Anchor>#</a></span></h4><p>Advising <code>org-babel-execute:sql</code> in this way allows me to use <code>#+begin_src sql :engine bq :results raw</code> blocks in org-babel and execute them with <code>C-c C-c</code>. More
commonly, though, I set <code>#+PROPERTY: header-args:sql :engine bq :results raw</code> at
the top of the document so that I can just mark a <code>src</code> block as <code>sql</code> and be done
with it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>org-babel-execute:bq</span> <span class=p>(</span><span class=nv>orig-fun</span> <span class=nv>body</span> <span class=nv>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nv>string-equal-ignore-case</span> <span class=p>(</span><span class=nf>cdr</span> <span class=p>(</span><span class=nf>assq</span> <span class=nb>:engine</span> <span class=nv>params</span><span class=p>))</span> <span class=s>&#34;bq&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>json-to-org-table-parse-json-string</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>org-babel-execute:shell</span> <span class=p>(</span><span class=nf>concat</span> <span class=s>&#34;bq query --format=json --nouse_legacy_sql &#39;&#34;</span> <span class=nv>body</span> <span class=s>&#34;&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                <span class=nv>params</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>org-babel-execute:sql</span> <span class=nv>body</span> <span class=nv>params</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>advice-add</span> <span class=ss>&#39;org-babel-execute:sql</span> <span class=nb>:around</span> <span class=nf>#&#39;</span><span class=nv>org-babel-execute:bq</span><span class=p>)</span>
</span></span></code></pre></div><p>This also typically requires <code>#+OPTIONS: ^:nil</code> at the top of the Org document to
stop underscores from messing up how column names are displayed.</p><h4 id=bigquery-exception-markers class="relative group"><span class="org-todo todo TODO">TODO</span> BigQuery exception markers <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bigquery-exception-markers aria-label=Anchor>#</a></span></h4><p>When running BigQuery from a <code>*compilation*</code> buffer, it would be nice if I could get
error markers to jump directly to the issue.</p><h3 id=python class="relative group">Python <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#python aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;Pipfile&#34;</span> <span class=o>.</span> <span class=nv>toml-ts-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=pyright-error-links-in-compilation class="relative group">Pyright error links in <code>*compilation*</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pyright-error-links-in-compilation aria-label=Anchor>#</a></span></h4><p>The <code>M-x compile</code> feature does not recognize or parse <code>pyright</code> error messages out
of the box, so I add that support myself. Here&rsquo;s an example error message:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/home/robb/tmp/errors.py/
</span></span><span class=line><span class=cl>  /home/robb/tmp/errors.py:1:1 - error: &#34;foo&#34; is not defined (reportUndefinedVariable)
</span></span><span class=line><span class=cl>  /home/robb/tmp/errors.py:1:1 - warning: Expression value is unused (reportUnusedExpression)
</span></span><span class=line><span class=cl>  /home/robb/tmp/errors.py:4:12 - error: Operator &#34;+&#34; not supported for types &#34;str&#34; and &#34;Literal[1]&#34;
</span></span><span class=line><span class=cl>    Operator &#34;+&#34; not supported for types &#34;str&#34; and &#34;Literal[1]&#34; (reportGeneralTypeIssues)
</span></span><span class=line><span class=cl>2 errors, 1 warning, 0 informations
</span></span></code></pre></div><p>To get the basic <code>M-g M-n</code> and <code>M-g M-p</code> navigation working, we just need a regex to
parse file name, line, and column number.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>with-eval-after-load</span> <span class=ss>&#39;compile</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;compilation-error-regexp-alist-alist</span>
</span></span><span class=line><span class=cl>               <span class=o>&#39;</span><span class=p>(</span><span class=nv>pyright</span> <span class=s>&#34;^[[:blank:]]+\\(.+\\):\\([0-9]+\\):\\([0-9]+\\).*$&#34;</span> <span class=mi>1</span> <span class=mi>2</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;compilation-error-regexp-alist</span> <span class=ss>&#39;pyright</span><span class=p>))</span>
</span></span></code></pre></div><p>It would be nice if we could also capture the <code>\\(error\\|warning\\)</code> part as
&ldquo;KIND&rdquo;, but I&rsquo;m struggling to get it working.</p><h4 id=python-check-with-ruff class="relative group">Python check with &ldquo;ruff&rdquo; <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#python-check-with-ruff aria-label=Anchor>#</a></span></h4><p>Another nice vanilla feature of <code>python-mode</code> is <code>M-x python-check</code>, which runs a
pre-specified linter. Setting that to <code>mypy</code> or <code>pyright</code> if either of those
programs exist is a small time saver.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>python</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;eglot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>python-check-command</span> <span class=s>&#34;ruff&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>flymake-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>blacken-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-ts-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>flymake-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-ts-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>blacken-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; (add-to-list &#39;eglot-server-programs &#39;((python-mode python-ts-mode) &#34;ruff-lsp&#34;))</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span></code></pre></div><h4 id=fix-microsoft-windows-issues class="relative group">Fix Microsoft Windows Issues <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fix-microsoft-windows-issues aria-label=Anchor>#</a></span></h4><p>At one point, I ran into something similar to this <a href=https://github.com/jorgenschaefer/elpy/issues/733>elpy issue</a> on Windows. The
culprit was &ldquo;App Execution Aliases&rdquo; with python and python3 redirecting to the
windows store. Using this fixed it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>winkey -&gt; Manage app execution aliases -&gt; uncheck python and python3
</span></span></code></pre></div><p>Also on Windows - a <code>pip install</code> of <code>pyreadline3</code> is required to make
tab-completion work at all. It provides the <code>readline</code> import symbol.</p><h4 id=make-check-command-and-virtualenv-root-safe-for-dot-dir-locals-dot-el class="relative group">Make check command and virtualenv root safe for .dir-locals.el <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#make-check-command-and-virtualenv-root-safe-for-dot-dir-locals-dot-el aria-label=Anchor>#</a></span></h4><p>Virtualenvs require <code>.dir-locals.el</code> to have something like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>((</span><span class=nv>python-mode</span> <span class=o>.</span> <span class=p>((</span><span class=nv>python-shell-virtualenv-root</span> <span class=o>.</span> <span class=s>&#34;/path/to/my/.venv&#34;</span><span class=p>))))</span>
</span></span></code></pre></div><p>However, this only operates on `run-python&rsquo; shells. Also, for projects, we need to
make sure that setting the virtualenv root is marked as safe.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;python-check-command</span> <span class=ss>&#39;safe-local-variable</span> <span class=nf>#&#39;stringp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;python-shell-virtualenv-root</span> <span class=ss>&#39;safe-local-variable</span> <span class=nf>#&#39;stringp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nf>put</span> <span class=ss>&#39;pyvenv-default-virtual-env-name</span> <span class=ss>&#39;safe-local-variable</span> <span class=nf>#&#39;stringp</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=emacs-jupyter class="relative group">Emacs Jupyter? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#emacs-jupyter aria-label=Anchor>#</a></span></h4><p>Eventually, I would like to try the <a href=https://github.com/dzop/emacs-jupyter>emacs-jupyter</a> package to interface with
Jupyter kernels from org-mode.</p><h4 id=pyrightconfig-dot-json class="relative group">pyrightconfig.json <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pyrightconfig-dot-json aria-label=Anchor>#</a></span></h4><p>The most consistent way to get <code>eglot</code> to properly configure the python virtual
environment with <code>pyright</code> is to have a static file at the root of the project,
called <code>pyrightconfig.json</code>. I wrote a short plugin that allows me to select a
directory using <code>completing-read</code> and have Emacs write the content of
<code>pyrightconfig.json</code> based on what I selected, in the appropriate directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pyrightconfig</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=p>(</span><span class=nv>python</span><span class=p>))</span>
</span></span></code></pre></div><p>Configuring pyright this way rather than &ldquo;activating&rdquo; an environment through
Emacs (ala <code>pythonic-activate</code> or similar) means we can be running the language
server in more than one project at a time, each pointing to its respective
virtual environment.</p><h4 id=activating-virtual-environments-over-tramp class="relative group">Activating Virtual Environments Over Tramp <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#activating-virtual-environments-over-tramp aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tramp-venv</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span>
</span></span><span class=line><span class=cl>  <span class=p>((</span><span class=s>&#34;C-c t v a&#34;</span> <span class=o>.</span> <span class=nv>tramp-venv-activate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c t v d&#34;</span> <span class=o>.</span> <span class=nv>tramp-venv-deactivate</span><span class=p>)))</span>
</span></span></code></pre></div><h4 id=pyvenv-for-virtual-environments class="relative group">Pyvenv for virtual environments <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pyvenv-for-virtual-environments aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>pyvenv</span>
</span></span><span class=line><span class=cl>  <span class=nb>:init</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>if</span> <span class=p>(</span><span class=nf>eq</span> <span class=nv>system-type</span> <span class=ss>&#39;darwin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>setenv</span> <span class=s>&#34;WORKON_HOME&#34;</span> <span class=s>&#34;~/micromamba/envs/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>setenv</span> <span class=s>&#34;WORKON_HOME&#34;</span> <span class=s>&#34;~/.conda/envs/&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span>
</span></span><span class=line><span class=cl>  <span class=p>((</span><span class=s>&#34;C-c p w&#34;</span> <span class=o>.</span> <span class=nv>pyvenv-workon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c p d&#34;</span> <span class=o>.</span> <span class=nv>pyvenv-deactivate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=s>&#34;C-c p a&#34;</span> <span class=o>.</span> <span class=nv>pyvenv-activate</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>pyvenv-mode</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=executing-cell-by-cell class="relative group"><span class="org-todo todo TODO">TODO</span> Executing cell-by-cell <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#executing-cell-by-cell aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>code-cells</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>((</span><span class=nv>python-mode</span> <span class=o>.</span> <span class=nv>code-cells-mode-maybe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>python-ts-mode</span> <span class=o>.</span> <span class=nv>code-cells-mode-maybe</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;code-cells-eval-region-commands</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>python-ts-mode</span> <span class=o>.</span> <span class=nv>python-shell-send-region</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=markdown class="relative group">Markdown <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#markdown aria-label=Anchor>#</a></span></h3><p>Some folks like to write markdown without hard line breaks. When viewing those
documents, I can use <code>M-x renz/md-hook</code> to view it as if there were line breaks in
it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/md-hook</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;View buffer in visual fill mode with 80 character width.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>interactive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>visual-fill-column-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>fill-column</span> <span class=mi>80</span><span class=p>))</span>
</span></span></code></pre></div><p>I make a lot of spelling mistakes as I type&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;markdown-mode-hook</span> <span class=ss>&#39;flyspell-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;markdown-mode-hook</span> <span class=ss>&#39;auto-fill-mode</span><span class=p>)</span>
</span></span></code></pre></div><p>And I like to see language syntax highlighting within code fences.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>markdown-fontify-code-blocks-natively</span> <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=missing-auto-modes class="relative group">Missing auto-modes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#missing-auto-modes aria-label=Anchor>#</a></span></h3><p>These really should already be in <code>auto-mode-alist</code>, but aren&rsquo;t for some reason.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.rs\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>rust-ts-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.go\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>go-ts-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.ts\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>typescript-ts-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;auto-mode-alist</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.dockerfile\\&#39;&#34;</span> <span class=o>.</span> <span class=nv>dockerfile-ts-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=csv-mode class="relative group">csv-mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#csv-mode aria-label=Anchor>#</a></span></h3><p>Handy for viewing data quickly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>csv-mode</span>
</span></span><span class=line><span class=cl>  <span class=nb>:mode</span> <span class=s>&#34;\\.csv\\&#39;&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=tool-configuration class="relative group">Tool configuration <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tool-configuration aria-label=Anchor>#</a></span></h2><p>These are tweaks for self-contained tooling, such as third party packages or
built-in packages that have a well-defined scope and namespace.</p><h3 id=eldoc class="relative group"><code>eldoc</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#eldoc aria-label=Anchor>#</a></span></h3><p>I find it very distracting when <code>eldoc</code> suddenly pops up and consumes a large part
of the screen for docstrings in python.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>eldoc-echo-area-use-multiline-p</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=imenu class="relative group"><code>imenu</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#imenu aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>imenu</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>imenu-auto-rescan</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>org-imenu-depth</span> <span class=mi>3</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=dabbrev-swap-m-and-c-m class="relative group"><code>dabbrev</code>: swap <code>M-/</code> and <code>C-M-/</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dabbrev-swap-m-and-c-m aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dabbrev</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; Swap M-/ and C-M-/</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;M-/&#34;</span> <span class=o>.</span> <span class=nv>dabbrev-completion</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-M-/&#34;</span> <span class=o>.</span> <span class=nv>dabbrev-expand</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=c1>;; Other useful Dabbrev configurations.</span>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>dabbrev-ignored-buffer-regexps</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;\\.\\(?:pdf\\|jpe?g\\|png\\)\\&#39;&#34;</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=dired class="relative group">dired <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dired aria-label=Anchor>#</a></span></h3><p>By default, <code>dired</code> uses bytes instead of &ldquo;K&rdquo;, &ldquo;Mb&rdquo;, or &ldquo;G&rdquo; for file sizes. I
also have it hide the mode, size, and owner of each file by default.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>dired</span>
</span></span><span class=line><span class=cl>  <span class=nb>:hook</span> <span class=p>(</span><span class=nv>dired-mode</span> <span class=o>.</span> <span class=nv>dired-hide-details-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-listing-switches</span> <span class=s>&#34;-alFh&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>dired-dwim-target</span> <span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>Also enabled above is Do-What-I-Mean (DWIM) copying. This is for when two dired
windows are open, and we want to copy something from one location to the other.
By enabling <code>dired-dwim-target</code>, it auto-populates the minibuffer with the other
dired window&rsquo;s path when issuing a copy command with <code>C</code>.</p><h3 id=coterm-mode class="relative group">Coterm mode <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#coterm-mode aria-label=Anchor>#</a></span></h3><p>Adds the ability to use TUI programs in shell mode.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>coterm</span>
</span></span><span class=line><span class=cl>  <span class=nb>:unless</span> <span class=p>(</span><span class=nv>renz/windowsp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>coterm-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=visual-fill-column class="relative group">Visual fill column <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#visual-fill-column aria-label=Anchor>#</a></span></h3><p>For visual lines, this adds line breaks at the fill-column value. Especially
useful for prose that is meant to be copied to other mediums, such as email or
word.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>visual-fill-column</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;visual-line-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>visual-fill-column-mode</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=eww-search-engine-and-browser class="relative group">eww - search engine and browser <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#eww-search-engine-and-browser aria-label=Anchor>#</a></span></h3><p>Ecosia requires JavaScript, unfortunately.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>eww</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span> <span class=p>(</span><span class=nb>setq</span> <span class=nv>eww-search-prefix</span> <span class=s>&#34;https://duckduckgo.com/html/?q=&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=esup-startup-time-profiling class="relative group">Esup: startup time profiling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#esup-startup-time-profiling aria-label=Anchor>#</a></span></h3><p><a href=https://github.com/jschaf/esup>esup</a> is a tool for profiling the startup time of Emacs. This snippet is a work
around of a bug where esup tries to step into the byte-compiled version of
`cl-lib&rsquo;, and fails horribly: <a href=https://github.com/jschaf/esup/issues/85>https://github.com/jschaf/esup/issues/85</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>esup</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c x p&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>esup-depth</span> <span class=mi>0</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=reloading-emacs class="relative group">Reloading Emacs <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#reloading-emacs aria-label=Anchor>#</a></span></h3><p>Often used when changing up my <code>init.el</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>restart-emacs</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>(</span><span class=s>&#34;C-c x r&#34;</span> <span class=o>.</span> <span class=nv>restart-emacs</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=language-server-protocol--lsp--with-eglot class="relative group">Language Server Protocol (LSP) with <code>eglot</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#language-server-protocol--lsp--with-eglot aria-label=Anchor>#</a></span></h3><p>As of version 29, <a href=https://github.com/joaotavora/eglot>eglot</a> (Emacs polyGLOT) is bundled with Emacs. It provides Emacs with the
client side configuration for the <a href=https://microsoft.github.io/language-server-protocol/>language server protocol</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>eglot</span>
</span></span><span class=line><span class=cl>  <span class=nb>:bind</span> <span class=p>((</span><span class=s>&#34;C-c l c&#34;</span> <span class=o>.</span> <span class=nv>eglot-reconnect</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l d&#34;</span> <span class=o>.</span> <span class=nv>flymake-show-buffer-diagnostics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l f f&#34;</span> <span class=o>.</span> <span class=nv>eglot-format</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l f b&#34;</span> <span class=o>.</span> <span class=nv>eglot-format-buffer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l l&#34;</span> <span class=o>.</span> <span class=nv>eglot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l r n&#34;</span> <span class=o>.</span> <span class=nv>eglot-rename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=s>&#34;C-c l s&#34;</span> <span class=o>.</span> <span class=nv>eglot-shutdown</span><span class=p>)))</span>
</span></span></code></pre></div><p>To have <code>eglot</code> always start up for a python buffer, we would tangle this line
into <code>init.el</code>. However, this can cause a significant loading delay over Tramp,
and I would prefer snappy, simple access with LSP provided on an as-needed
basis.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-mode-hook</span> <span class=ss>&#39;eglot-ensure</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=side-show-semantic-mode class="relative group">Side show: <code>semantic-mode</code> <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#side-show-semantic-mode aria-label=Anchor>#</a></span></h4><p>For a while, it looks like Emacs was trying out something called <a href=https://www.gnu.org/software/emacs/manual/html_node/semantic/Semantic-mode.html>semantic-mode</a>,
which looks a lot like a precursor to what we now know as the <a href=https://microsoft.github.io/language-server-protocol/>Language Server
Protocol</a>. Enabling it was done through adding the <code>semantic-mode</code> hook to your
language&rsquo;s major mode hook:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;python-mode-hook</span> <span class=ss>&#39;semantic-mode</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=treesitter class="relative group">TreeSitter <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#treesitter aria-label=Anchor>#</a></span></h3><h4 id=about-treesitter-and-its-load-paths class="relative group">About TreeSitter and its Load Paths <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#about-treesitter-and-its-load-paths aria-label=Anchor>#</a></span></h4><p>Emacs 29 added native <a href=https://tree-sitter.github.io/tree-sitter/>TreeSitter</a> support. TreeSitter is a new way of
incrementally parsing source code that offers superior navigation and syntax
highlighting. To fully realize this benefit, however, it requires that we
install <code>tree-sitter</code> grammars independently from Emacs. Right now, I&rsquo;m using
<a href=https://github.com/casouri/tree-sitter-module>casouri&rsquo;s modules</a>, which I build and install under <code>~/.emacs.d/tree-sitter</code>, if
they don&rsquo;t already exist under <code>/usr/local/lib/</code> or <code>~/.local/lib</code>. In case of the
latter, I just add extra paths to <code>treesit-extra-load-path</code> explicitly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>boundp</span> <span class=ss>&#39;treesit-extra-load-path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;treesit-extra-load-path</span> <span class=s>&#34;/usr/local/lib/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;treesit-extra-load-path</span> <span class=s>&#34;~/.local/lib/&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>For the full instructions, the commit history of adding the <code>tree-sitter</code> modules
to Emacs included a <a href="https://git.savannah.gnu.org/cgit/emacs.git/plain/admin/notes/tree-sitter/starter-guide?h=feature/tree-sitter">full guide</a>, which can be read in Info under &ldquo;Parsing Program
Source&rdquo;.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>C-h i d m elisp RET g Parsing Program Source RET
</span></span></code></pre></div><p>Enabling TreeSitter is done on a per-language basis to override the default
major mode with the corresponding TreeSitter version.</p><h4 id=automatically-using-treesitter-modes class="relative group">Automatically Using TreeSitter Modes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#automatically-using-treesitter-modes aria-label=Anchor>#</a></span></h4><p>We will have to wait until Emacs 30+ for automatic fallback. Until then, I&rsquo;m
using a workaround that I&rsquo;ve posted to GitHub and MELPA as <a href=https://github.com/renzmann/treesit-auto>treesit-auto</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>treesit-auto</span>
</span></span><span class=line><span class=cl>  <span class=nb>:custom</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>treesit-auto-install</span> <span class=ss>&#39;prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>global-treesit-auto-mode</span><span class=p>))</span>
</span></span></code></pre></div><p>Before it was published to MELPA, I used a git subtree to manage the plugin.
This is a pretty useful technique, so I keep these two one-liners around in case
I need to reference or copy them. To get a copy of something as a subtree, I
use this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git subtree add -P site-lisp/treesit-auto git@github.com:renzmann/treesit-auto main --squash
</span></span></code></pre></div><p>Fetching updates is a similar command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git subtree pull -P site-lisp/treesit-auto git@github.com:renzmann/treesit-auto main --squash
</span></span></code></pre></div><h4 id=ooo-aaah-shiny-colors class="relative group">Ooo, aaah, shiny colors <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ooo-aaah-shiny-colors aria-label=Anchor>#</a></span></h4><p>I like to program &ldquo;in Skittles&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq-default</span> <span class=nv>treesit-font-lock-level</span> <span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=tramp class="relative group">Tramp <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tramp aria-label=Anchor>#</a></span></h3><p>Tramp (Transparent Remote Access Multiple Protocol) allows us to access files on
a remote machine, and edit them locally. This is great for simple changes or
quickly testing out some Python on a VM somewhere. It isn&rsquo;t as snappy as using
the TTY version or an X-forwarded Emacs from the server directly, so if I <em>can</em>
set up Emacs remotely, I usually do. When I don&rsquo;t want to or don&rsquo;t have the
time, Tramp is a godsend. There are, however, many foibles to guard against,
particularly with how interacts with version control and <code>.dir-locals</code>. The
Tramp manual (distributed with Emacs) recommends adjusting these for some speed
improvements:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>use-package</span> <span class=nv>tramp</span>
</span></span><span class=line><span class=cl>  <span class=nb>:defer</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>setq</span> <span class=nv>vc-handled-backends</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>Git</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>file-name-inhibit-locks</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=nv>tramp-inline-compress-start-size</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>        <span class=nv>tramp-copy-size-limit</span> <span class=mi>10000</span>
</span></span><span class=line><span class=cl>        <span class=nv>tramp-verbose</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;tramp-remote-path</span> <span class=ss>&#39;tramp-own-remote-path</span><span class=p>))</span>
</span></span></code></pre></div><p>eglot is <a href=https://github.com/joaotavora/eglot/issues/859>actively working</a> on an issue related to timers causing a &ldquo;Forbidden
reentrant call of Tramp&rdquo; message and freezing. In the meantime, this setting
was recommended.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>tramp-use-ssh-controlmaster-options</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>For some time I was having a lot of trouble with prohibitive slowness over
Tramp, and after careful scrutiny of the logs on (I believe) <code>tramp-verbose 6</code>, I
found out that enabling remote dir-locals was causing a huge bottleneck. On
every operation it would trace up the filesystem tree back to the root
directory, scanning for a <code>.dir-locals</code> file. Since some of the drives were
network-mounted, this caused thousands of network calls per file operation,
obviously slowing things down a lot. Because of this, I&rsquo;ve opted to simply
disable <code>.dir-locals</code> over Tramp entirely, since I don&rsquo;t really use it much, if at
all.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; (setq enable-remote-dir-locals t)</span>
</span></span></code></pre></div><p><a href=https://www.gnu.org/software/emacs/manual/html_node/tramp/Frequently-Asked-Questions.html>Disabling VC</a> <em>does</em> seem to speed things up a little, but it&rsquo;s not an acceptable
thing to put in, since I so frequently use VC over tramp. Fully disabling VC
would include this snippet:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>remove-hook</span> <span class=ss>&#39;find-file-hook</span> <span class=ss>&#39;vc-find-file-hook</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>vc-ignore-dir-regexp</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>format</span> <span class=s>&#34;\\(%s\\)\\|\\(%s\\)&#34;</span>
</span></span><span class=line><span class=cl>              <span class=nv>vc-ignore-dir-regexp</span>
</span></span><span class=line><span class=cl>              <span class=nv>tramp-file-name-regexp</span><span class=p>))</span>
</span></span></code></pre></div><p>Additionally, these came up as other potential options <a href=https://github.com/doomemacs/doomemacs/issues/3909>from the doom-emacs
issues</a>, which I do not currently include.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>tramp-default-method</span> <span class=s>&#34;scp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>projectile--mode-line</span> <span class=s>&#34;Projectile&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>I often need to set these in ~/.ssh/config for TRAMP to speed up</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Host *
</span></span><span class=line><span class=cl>     ControlMaster auto
</span></span><span class=line><span class=cl>     ControlPath ~/.ssh/master-%h:%p
</span></span><span class=line><span class=cl>     ControlPersist 10m
</span></span><span class=line><span class=cl>     ForwardAgent yes
</span></span><span class=line><span class=cl>     ServerAliveInterval 60
</span></span></code></pre></div><h3 id=shell-commands class="relative group">Shell commands <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#shell-commands aria-label=Anchor>#</a></span></h3><p>The Async command buffer&rsquo;s default behavior is to print <code>^M</code> characters (the
carriage return) instead of actually clearing text. This is problematic for
spinners and progress bars, so I have a little hack to work around that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>renz/async-shell-command-filter-hook</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;Filter async shell command output via </span><span class=ss>`comint-output-filter&#39;</span><span class=s>.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>when</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>buffer-name</span> <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))</span> <span class=s>&#34;*Async Shell Command*&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; When `comint-output-filter&#39; is non-nil, the carriage return characters ^M</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; are displayed</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nb>setq-local</span> <span class=nv>comint-inhibit-carriage-motion</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>when-let</span> <span class=p>((</span><span class=nv>proc</span> <span class=p>(</span><span class=nf>get-buffer-process</span> <span class=p>(</span><span class=nf>current-buffer</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; Attempting a solution found here:</span>
</span></span><span class=line><span class=cl>      <span class=c1>;; https://gnu.emacs.help.narkive.com/2PEYGWfM/m-chars-in-async-command-output</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>set-process-filter</span> <span class=nv>proc</span> <span class=ss>&#39;comint-output-filter</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add-hook</span> <span class=ss>&#39;shell-mode-hook</span> <span class=nf>#&#39;</span><span class=nv>renz/async-shell-command-filter-hook</span><span class=p>)</span>
</span></span></code></pre></div><p>There might be a better way, but this mostly works for now.</p><h2 id=don-t-forget-about-these class="relative group">Don&rsquo;t forget about these <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#don-t-forget-about-these aria-label=Anchor>#</a></span></h2><p>There are several other interesting options that I haven&rsquo;t tried out yet, including:</p><ul><li><input disabled type=checkbox> <a href=https://github.com/abo-abo/org-download>org-download</a></li><li><input disabled type=checkbox> <a href=https://github.com/oantolin/math-delimiters>math-delimiters</a></li><li><input disabled type=checkbox> <a href=https://github.com/oantolin/placeholder>oantolin/placeholder</a></li><li><input disabled type=checkbox> <a href=https://notmuchmail.org/notmuch-emacs/>notmuch for email</a></li></ul><h2 id=footer class="relative group">Footer <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#footer aria-label=Anchor>#</a></span></h2><p>Thank you for reading &rsquo;till the end or for being interested on how to end an
Emacs package. So that&rsquo;s it, let&rsquo;s gracefully finish tangling everything:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>provide</span> <span class=ss>&#39;init.el</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>;;; init.el ends here</span>
</span></span></code></pre></div></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=flex><img class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full" width=96 height=96 alt=Author src=/img/robb_python_grey_huf4e52b91f6345de53e62f8c2a64f08ae_471021_192x192_fill_box_smart1_3.png><div class=place-self-center><div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Robert Enzmann</div><div class="text-sm text-neutral-700 dark:text-neutral-400">I handle <code>make</code>s and snakes</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:robbenzmann@gmail.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/renzmann target=_blank aria-label=Github rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/renzmann target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://reddit.com/user/renzmann target=_blank aria-label=Reddit rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a></div></div></div></div></footer></article><div class="absolute top-[110vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-[-5.5rem]"><a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><div id=search-wrapper class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible" data-url=https://robbmann.io><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div><footer class="py-10 print:hidden"><div class="flex justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023
Robert Enzmann</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"><button id=appearance-switcher class="w-12 h-12" type=button title="Switch to dark appearance">
<span class="inline dark:hidden"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></span><span class="hidden dark:inline"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></span></button></div></div></footer></body></html>